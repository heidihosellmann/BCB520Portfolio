{
  "hash": "823e1f4887e925f8e1c777a5e0286863",
  "result": {
    "markdown": "---\ntitle: \"BCB 520 Assignment 4\"\nsubtitle: \"Marks and Channels\"\nauthor: \"Heidi Sellmann\"\ndate: \"2024-02-08\"\ncategories: [Assignments, Data Viz]\nimage: \"cytoswine.jpg\"\ncode-fold: true\ncode-tools: true\ndescription: \"My Cytoswine and micro-pig-ome data\"\nformat: html\neditor: visual\noutput:\n  quarto::quarto_html:\n    error: FALSE\n    warning: FALSE\n---\n\n\n# Recalling Assignment 3- Task Abstraction\n\n## Import Data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(readxl)\nCytokine_summary <- read_excel(\"Cytokine_summary.xlsx\")\nView(Cytokine_summary)\nknitr::kable(Cytokine_summary)\n```\n\n::: {.cell-output-display}\n|Pig | IL1B_Jej_pg_mL| IL1B_Ile_pg_mL| IL1B_Col_pg_mL| TNFA_Jej_pg_mL| TNFA_Ile_pg_mL| TNFA_Col_pg_mL| IL8_Jej_pg_mL| IL8_Ile_pg_mL| IL8_Col_pg_mL|\n|:---|--------------:|--------------:|--------------:|--------------:|--------------:|--------------:|-------------:|-------------:|-------------:|\n|P1  |        158.107|        258.529|         18.902|         10.084|        191.685|         67.410|      2717.095|      3244.064|        48.389|\n|C1  |        304.570|        300.510|        173.388|          5.293|        148.321|         53.500|      1807.191|      2747.520|       521.019|\n|HM1 |        126.749|         92.684|         80.020|          0.000|        163.895|          0.000|      2163.072|      1842.670|        93.936|\n|HM2 |         90.214|         72.580|         75.545|          0.000|        130.676|          0.000|      3434.170|      3433.543|       194.084|\n|HM3 |        114.224|         79.751|        239.901|          0.000|          0.000|         28.050|      1649.797|      1678.069|       334.678|\n|HM4 |        132.318|        107.964|        155.655|          3.612|          5.265|         18.105|      3390.124|      3088.125|       373.427|\n|HM5 |         68.657|         49.695|         12.045|          0.000|        112.351|          0.000|      3148.633|      3153.588|       172.843|\n|HM6 |        112.428|         57.860|         52.582|          0.000|          0.000|          0.000|      3088.206|      4084.593|       183.157|\n|P2  |        194.675|        145.165|         63.666|         12.729|         18.287|         89.610|      2474.794|      2692.826|       880.425|\n|C2  |        401.575|        564.465|        305.068|         42.442|         17.261|         84.509|      1635.162|      1030.576|       255.938|\n|IF1 |        174.037|        130.035|         38.956|          0.000|        105.243|          3.978|      2013.397|      1678.351|        49.232|\n|IF2 |        126.663|        115.666|         76.857|          0.000|         63.294|          4.975|      3399.788|      1727.786|       116.573|\n|IF3 |        141.120|         53.064|        182.891|          4.574|          0.000|         12.948|      3766.222|       504.454|        38.554|\n|IF4 |        132.275|         78.283|         18.266|          9.628|        154.257|          0.000|      3705.406|      2293.403|       222.193|\n|IF5 |        111.800|         91.316|         82.741|          0.000|        223.890|          4.293|      3228.713|      2499.064|       103.378|\n|IF6 |        159.411|        120.352|         31.099|          0.000|          5.171|          0.000|      2001.489|      2659.008|       173.974|\n:::\n:::\n\n\nI am adding in my **DATA DICTIONARY** from Assignment 2:\n\n## Data Dictionary:\n\n### Flat Table\n\nJust one excel sheet with **items** and **attributes**.\n\n### Items (rows) = R studio calls these observations.\n\nIn Cytokine_summary, there are 16 pigs. P1 and P2 were pilot pigs fed piglet milk replacer formula. C1 and C2 were farm control pigs (siblings) raised at a farm (the same one as the other pigs), feeding from their own mom, and then we received them for necropsy on day of life (DOL) 28. HM1-6 were fed human milk for 28 days in our lab. IF1-6 were fed infant formula for 28 days in our lab. Pairs of HM and IF (such as HM1 and IF1) were siblings and both raised at the same time, but in different cages.\n\n### Attributes (columns) = R studio calls these variables.\n\nIn Cytokine_summary, there are 10 variables. One of these columns = \"Pigs\" and specifies the observations described above. All other variables are cytokine values from ELISAs on various intestinal tissues harvested fromt the pigs at necropsy on DOL 28 (except HM/IF5- they had to stay with us a little longer). Detected ELISAs tested included IL1B, TNFA, and IL8. Each of these cytokines were tested on the jejunum (Jej), ileum (Ile), and Colon (Col) of each pig. Concentration units of for each measurement were in pg/mL.\n\n## Load Libraries\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.4\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.4.4     ✔ tibble    3.2.1\n✔ lubridate 1.9.3     ✔ tidyr     1.3.0\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n:::\n\n```{.r .cell-code}\nlibrary(ggplot2)\nlibrary(ggpubr)\nlibrary(rstatix)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'rstatix'\n\nThe following object is masked from 'package:stats':\n\n    filter\n```\n:::\n\n```{.r .cell-code}\nlibrary(dplyr)\n```\n:::\n\n\nNow that I have the necessary data and packages, I want to make a box blot distribution of my various cytokines per pig feeding group - HM, IF, P, and C. Barrie helped me with this!\n\n## Organize the Data\n\nHere we add another column into Cytokine_summary via R\n\n\n::: {.cell}\n\n```{.r .cell-code}\nCytokine_summary <- Cytokine_summary %>%\n  mutate(Diet = str_sub(Pig, 1, 1))\n```\n:::\n\n\n## What does each diet look like?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(Cytokine_summary, aes(x = Diet, y = IL1B_Jej_pg_mL)) + \n  geom_boxplot() + \n  geom_jitter()\n```\n\n::: {.cell-output-display}\n![](Assignment4_files/figure-html/Individual distributions-1.png){width=672}\n:::\n:::\n\n\n**Figure 1.** Box and whisker plots displaying piglet diet group differences in expression levels (pg/mL) of the pro-inflammatory cytokine IL1B in the jejunum. Jitter overlay is representative of each individual pig.\n\n### Legend:\n\nC = Farm Control\n\nH = HM\n\nI = IF\n\nP = Lab Control\n\nNow I could create individual ones of these for each column... but we are going to try to work smarter, not harder, and create a new data frame to get all these types of plots into 1 figure.\n\n## Creating 9 plots in 1 figure\n\nFirst we break up the columns 2-10 to their cytokine and their region.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nCytokine_long <- Cytokine_summary %>%\n  pivot_longer(cols = 2:10, names_to =\"Reg_Cyt\",\n values_to = \"Expression\") %>%\n  separate(Reg_Cyt, into = c(\"Cytokine\", \"Region\"), sep = \"_\", remove = FALSE)\n```\n:::\n\n\nCytokine_long looks good!\n\nNow to put that into a boxplot with jitter overlay. We facet_wrapped in order to make subplots from 1 plot (slice it up for the viewers).\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(Cytokine_long, aes(x = Diet, y = Expression)) + \n  geom_boxplot() + \n  geom_jitter() + \n  facet_wrap(Region ~ Cytokine, scales = \"free_y\")\n```\n\n::: {.cell-output-display}\n![](Assignment4_files/figure-html/Cytokine_long into boxplot/jitter plot-1.png){width=672}\n:::\n:::\n\n\n**Figure 2.** Box and whisker plots displaying piglet diet group differences in expression levels (pg/mL) of the pro-inflammatory cytokines IL1B, IL8, and TNFA in the jejunum, ileum, and colon. Jitter overlay is representative of each individual pig.\n\nGreat!\n\n# Onto Assignment 4- Manipulating Marks and Channels\n\nMoving forward from Figure 2., we wanted to see if there were any individual pigs driving differences.\n\n## Plot looking at individual pigs and cytokine z scores\n\nMake new data frame for Cytokine z-scores\n\n\n::: {.cell}\n\n```{.r .cell-code}\nCytokine_zscore <- Cytokine_summary %>%   mutate(across(.cols = 2:10, .fns = ~scale(.) %>% as.vector)) #scaling columns 2-10}\n```\n:::\n\n\nMake a boxplot now:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nCytokine_zscore_long <- Cytokine_zscore %>%   pivot_longer(cols = 2:10, names_to =\"Reg_Cyt\",  values_to = \"Expression_Z_Scores\") %>%   separate(Reg_Cyt, into = c(\"Cytokine\", \"Region\"), sep = \"_\", remove = FALSE)   # We just made the data long! First we break up the columns 2-10 to their cytokine and their region. # Don't worry about warning- says I have lots of _}\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(Cytokine_zscore_long, aes(x = Pig, y = Expression_Z_Scores)) +    geom_boxplot() +    geom_jitter(aes(color= Cytokine))\n```\n\n::: {.cell-output-display}\n![](Assignment4_files/figure-html/Boxplot of zscores with long data-1.png){width=672}\n:::\n:::\n\n\n**Figure 3.** Box and whisker plots of individual pigs and their overall cytokine expression z scores. Colors represent respective cytokines.\n\nSuper cool! Each pig has 9 dots = 9 cytokines readings (3 cytokines and 3 regions). Doesn't appear to be any real outlier pigs as a whole (i.e. none are extremely inflamed or non-inflamed for any measure). This shows us there doesn't appear to be hidden structure in my data.\n\n**ACTION** = SEARCH\n\n**TARGET** = ALL DATA\n\n## Now for manipulating...\n\nWhat if I add the **CHANNEL** of another dimension of **FILL/COLOR** to Figure 3?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(Cytokine_zscore_long, aes(x = Pig, y = Expression_Z_Scores, fill = Region)) +    \n  geom_boxplot() +    \n  geom_jitter(aes(color= Cytokine))\n```\n\n::: {.cell-output-display}\n![](Assignment4_files/figure-html/Boxplot filled-1.png){width=672}\n:::\n:::\n\n\n**Figure 4.** Box and whisker plots of individual pigs and their overall cytokine expression z scores. Colors represent respective cytokines and respective regions.\n\nActually, this might be quite helpful! Hmm... different colors?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nregion_colors <- c(\"orange\", \"purple\", \"yellow\")\n\nggplot(Cytokine_zscore_long, aes(x = Pig, y = Expression_Z_Scores, fill = Region)) +    \n  geom_boxplot() +    \n  geom_jitter(aes(color = Cytokine)) +\n  scale_fill_manual(values = region_colors)\n```\n\n::: {.cell-output-display}\n![](Assignment4_files/figure-html/Boxplot filled better colors-1.png){width=672}\n:::\n:::\n\n\n**Figure 5.** Box and whisker plots of individual pigs and their overall cytokine expression z scores. Colors represent respective cytokines and respective regions.\n\nHelpful or a hindrance, I don't know!\n\nHow about changing the **MARK** of **SHAPE**?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nregion_colors <- c(\"orange\", \"purple\", \"yellow\")\n\nggplot(Cytokine_zscore_long, aes(x = Pig, y = Expression_Z_Scores, fill = Region)) +    \n  geom_boxplot() +    \n  geom_jitter(aes(color = Cytokine), shape = 17) +  # Change shape to the desired value\n  scale_fill_manual(values = region_colors)\n```\n\n::: {.cell-output-display}\n![](Assignment4_files/figure-html/Boxplot with triangle jitter-1.png){width=672}\n:::\n:::\n\n\n**Figure 6.** Box and whisker plots of individual pigs and their overall cytokine expression z scores. Colors represent respective cytokines and respective regions.\n\nAlright... I am having too much fun here. Lastly, for my micro-pig-ome data, Barrie and I worked on relative abundance stacked barcharts. I won't go into it too much, but the data I am importing below are microbiome samples (from piglet fecal samples) representative of various timepoints. I want to manipulate the **CHANNEL** of **COLOR** to be a little more discriminating.\n\nThe following was copied from my pre_decontam project:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\nlibrary(magrittr)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'magrittr'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:purrr':\n\n    set_names\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:tidyr':\n\n    extract\n```\n:::\n\n```{.r .cell-code}\nlibrary(dplyr)\n\n# Reading in csv I sent to Barrie\ntest <- read.csv(\"test.csv\")\n\nggplot(data = test, aes(x = Sample_ID, y = Abundance, fill = Genus))+\n  geom_col(position = \"stack\")+\n  theme(axis.text.x = element_text(angle = 90, hjust = 1, size = 4))\n```\n\n::: {.cell-output-display}\n![](Assignment4_files/figure-html/Playing around with microbiome-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# get barchart, default colors, but would love to have x axis ordered. Barrie also modified x axis to be more readable.\n\ntest <- test %>%\n  mutate(Sample_ID = factor(Sample_ID, levels = unique(Sample_ID[order(typeSample)]))) #order x axis by typeSample\n\nggplot(data = test, aes(x = Sample_ID, y = Abundance, fill = Genus)) +\n  geom_col(position = \"stack\")+\n  theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0, size = 4))+\n geom_text(aes(x = Sample_ID, y = Inf, label = typeSample, color = typeSample), \n            vjust = 0, angle = 90, hjust = 1, size = 1) #add this line for adding text on top/color/legend, I think\n```\n\n::: {.cell-output-display}\n![](Assignment4_files/figure-html/Playing around with microbiome-2.png){width=672}\n:::\n:::\n\n\n**Figure 7.** Piglet microbiome relative abundances with poor color\n\nI am going to manipulate color now!\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(RColorBrewer)\ncustom_col15 <- c( \"#FF0000\", \"#00B0F0\", \"#FFFF00\", \"#96D050\", \"#CC3399\",\n \"#375623\", \"#FFC000\", \"#0070C0\", \"#990033\",\"#00B050\",\n \"#FF00FF\", \"#66FF99\", \"#F96E05\", \"#FFFF99\", \"#000000\")#,\n# \"#0000FF\", \"#FF7C80\", \"#CC66FF\", \"#00FF00\", \"#002060\")\n\nggplot(data = test, aes(x = Sample_ID, y = Abundance, fill = Genus)) +\n  geom_col(position = \"stack\")+\n  scale_fill_manual(values = custom_col15)+\n  theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0, size = 4))+\n geom_text(aes(x = Sample_ID, y = Inf, label = typeSample, color = typeSample), \n            vjust = 0, angle = 90, hjust = 1, size = 1) #add this line for adding text on top/color/legend, I think\n```\n\n::: {.cell-output-display}\n![](Assignment4_files/figure-html/Barrie Microbiome + Janet Colors-1.png){width=672}\n:::\n:::\n\n\n**Figure 7.** Piglet microbiome relative abundances with better color!\n\nThanks! TTFN!\n",
    "supporting": [
      "Assignment4_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}