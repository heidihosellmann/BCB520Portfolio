<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Heidi Sellmann">
<meta name="dcterms.date" content="2024-03-11">
<meta name="description" content="Grants and awards and bears, oh my!">
<title>Heidi’s BCB 520 Portfolio - BCB 520 - Midterm Portfolio Post</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><link rel="stylesheet" href="../../styles.css">
<link rel="stylesheet" href="styles.css">
</head>
<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg navbar-dark "><div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Heidi’s BCB 520 Portfolio</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item">
    <a class="nav-link" href="../../about.html" rel="" target="">
 <span class="menu-text">About Heidi</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/heidihosellmann/BCB520Portfolio" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
<div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav></header><!-- content --><header id="title-block-header" class="quarto-title-block default page-columns page-full"><div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <div class="quarto-title-block"><div><h1 class="title">BCB 520 - Midterm Portfolio Post</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
            <p class="subtitle lead">Evaluating Awards and Grants: UI vs.&nbsp;Others</p>
                  <div>
        <div class="description">
          Grants and awards and bears, oh my!
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">Assignment</div>
                <div class="quarto-category">DataViz</div>
                <div class="quarto-category">Tables</div>
                <div class="quarto-category">Project</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Heidi Sellmann </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">March 11, 2024</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content"><div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/knitr/man/opts_chunk.html">opts_chunk</a></span><span class="op">$</span><span class="fu">set</span><span class="op">(</span>echo<span class="op">=</span><span class="cn">FALSE</span>, warning<span class="op">=</span><span class="cn">FALSE</span>, error<span class="op">=</span><span class="cn">FALSE</span>, message<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="preamble" class="level1"><h1>PREAMBLE</h1>
<p>In this assignment I will be evaluating award/grant data from four federal sponsors: The National Science Foundation (NSF), The National Institutes of Health (NIH), The Department of Energy (DOE), and The US Department of Agriculture (USDA).</p>
</section><section id="data" class="level1"><h1>DATA</h1>
<p><strong>1. Department of Agriculture (NIFA)</strong> See the data dictionary here <a href="#fig-USDAtoUIDataDict">Figure&nbsp;1</a>. This includes agricultural related grants all the way from the early 2000s.</p>
<p><strong>2. Department of Energy (DOE)</strong> The data dictionary for this extensive data set can be accessed here <a href="#fig-DOEDataDict">Figure&nbsp;2</a>. This data is not restricted to a particular award recipient.</p>
<p><strong>3. National Institutes of Health (NIH)</strong> This data can be obtained from an Application Programming Interface (API). You can access this data’s dictionary here <a href="#fig-project_dfDataDict">Figure&nbsp;3</a>. This is quite a large data set with information on awards (related to health sciences) recieved by BSU and U of I between 2013-2024. Of note, this is an example of heirarchal data- some cells appear to have no values in them becuase there are actually multiple variables within those cells.</p>
<p><strong>4. National Science Foundation (NSF)</strong> The NSF also has an API, and the following code pulled down awards to the University of Idaho into a data frame called NSFtoUI. See the data dictionary here <a href="#fig-NSFtoUIDataDict">Figure&nbsp;4</a>. Briefly, this data set gives information on NSF grants awarded to the University of Idaho from 1975 to current day.</p>
</section><section id="question-1" class="level1"><h1>QUESTION 1</h1>
<p><em>Provide a visualization that shows our active awards from each sponsor. I need to see their start date and end date, the amount of the award, and the name of the Principal Investigator. I’m really interested in seeing how far into the future our current portfolio will exist. Are there a bunch of awards about to expire? Are there a bunch that just got funded and will be active for a while? Does this vary across sponsors?</em></p>
<p>I am going to manipulate and make new data sets for all sponsors. Then I will combine them all and plot a summary figure.</p>
<section id="putting-all-the-active-awards-from-various-sponsors-together" class="level2"><h2 class="anchored" data-anchor-id="putting-all-the-active-awards-from-various-sponsors-together">Putting all the active awards from various sponsors together</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="question1plot.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Question1Visualization</figcaption></figure>
</div>
<p><strong>Figure 3.</strong> This figure shows U of I PI last names and their active grants they have received as of 2017. The bars are colored by sponsor and the text amount signifies the amount they have received for said award. The USDA data is not included due to a lack of necessary variables. The strengths of this figure is that it displays, rather than over plots, PIs who have multiple awards. Limitations are that this figure only includes grants that have started in 2017 and on.</p>
</section></section><section id="question-2" class="level1"><h1>QUESTION 2</h1>
<p><em>What is the proportional representation of new awards to the UI from these various sources over the past 5 to 10 years? Are there any trends that are encouraging or discouraging?</em></p>
<section id="putting-all-the-sponsors-together" class="level2"><h2 class="anchored" data-anchor-id="putting-all-the-sponsors-together">Putting all the sponsors together</h2>
<div class="cell">
<div class="cell-output-display">
<p><img src="Assignment-6-Midterm_files/figure-html/Visualizing all sponsors-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>Figure 5.</strong> This figure shows the approximate trends of new grants received by the University of Idaho from various sponsors in the last 10 years.</p>
<p>Limitations include that the USDA data set did not have specifications denoting whether the awards were new or continuing, therefore, I was only able to go off the award date for being in the last 10 years and had to make the assumption all were new. This is most likely not the case, so the orange line should be interpreted with caution. In general, the USDA actually seems to be on the decline, which would be concerning given the type of school the University of Idaho is. As for the DOE, it seems we are on the rise during the past couple years. The NSF seems to be steady at the moment. Meanwhile, the NIH data was interesting. Upon updating this document, grants considered “new” a week previously were not considered “new” anymore. Therefore, I just included all grants from the past 10 years. All in all, this is an interesting figure to address general trends within the last decade.</p>
</section></section><section id="question-3" class="level1"><h1>QUESTION 3</h1>
<p><em>How is UI performing with these sponsors when compared to the following peer institutions: Boise State University,</em> <em>Idaho State University,</em> <em>Montana State University,</em> <em>University of Montana, and</em> <em>Washington State University?</em></p>
<p><em>Note that “performing” can mean a variety of different things. You must choose your metrics of performance and justify them.</em></p>
<p>I am going to use the API sources for this question (NIH and NSF) by manipulating the API addresses and then manipulating the data.</p>
<section id="combining-nih-and-nsf-for-neighboring-schools" class="level2"><h2 class="anchored" data-anchor-id="combining-nih-and-nsf-for-neighboring-schools">Combining NIH and NSF for neighboring schools</h2>
<div class="cell">
<div class="cell-output-display">
<p><img src="Assignment-6-Midterm_files/figure-html/Visualizing all the schools from NIH and NSF-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>Figure 6.</strong> This figure shows the award amounts of the active grants of each institution (and their various locations) sponsored by the NIH (coral) and NSF (blue).</p>
<p>I used the measures of active awards and their relative amounts from these sponsors to address how the U of I compares to neighboring institutions. Although not complex, these performance attributes capture important metrics nonetheless.</p>
<p>The limitations of this figure are first and foremost that it only addresses grants from the NIH and NSF, not the USDA and DOE. I chose to do this out of sake for convenience. Also, for the NIH, this time I added the indirect and direct costs to compute the award amount (in Figure 1., I only used direct cost). Further, because of the discrepant data sources, some of the institutions have multiple locations also shown in this figure. Although I could agglomerate the data so each institution has one reference point, I actually think this may be insightful to see how the smaller institutions compare to the larger ones. In general, I could clean this figure up to look a little nicer.</p>
<p>All in all, from this figure, we can see the U of I compares well in the realm of NSF grants. This is not so much the case for the NIH grants.</p>
</section></section><section id="summary" class="level1"><h1>SUMMARY</h1>
<p>In conclusion, this stuff is messy indeed! Throughout my three main visualizations, I found out what active grants the U of I has and how those compare across sponsors. I then expanded that information to compare specific sponsors to various other schools nearby. In general, we need more DOE and NIH work to be done. USDA and NSF are doing well, but we want to get back on the rise again (at least with the USDA).</p>
<p>I realized through this work that, as Barrie has alluded to, it indeed does take a lot of time going through these different data and finding what is similar/comparable and cleaning those aspects of the data in order to put visualizations together. Further, I learned the hard way that <strong>LESS IS MORE!</strong></p>
<p>I think it would be interesting to continue to explore and see how the U of I compares to other institutions with the other sponsors, and I wonder how data scientists wrap their heads around all these details!</p>
</section><section id="appendix" class="level1"><h1>APPENDIX</h1>
<section id="data-dictionary" class="level2"><h2 class="anchored" data-anchor-id="data-dictionary">Data Dictionary</h2>
<div class="cell">
<div id="fig-USDAtoUIDataDict" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><table class="table table-sm table-striped small">
<colgroup>
<col style="width: 21%">
<col style="width: 63%">
<col style="width: 15%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Attribute</th>
<th style="text-align: left;">Description</th>
<th style="text-align: left;">Type</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Award Date</td>
<td style="text-align: left;">Date when award was granted</td>
<td style="text-align: left;">Ordinal</td>
</tr>
<tr class="even">
<td style="text-align: left;">Grant Number</td>
<td style="text-align: left;">Unique ID for each grant</td>
<td style="text-align: left;">Item</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Proposal Number</td>
<td style="text-align: left;">N/A for all</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">Grant Title</td>
<td style="text-align: left;">N/A for all</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">State Name</td>
<td style="text-align: left;">State of award (all = IDAHO)</td>
<td style="text-align: left;">Categorical</td>
</tr>
<tr class="even">
<td style="text-align: left;">Grantee Name</td>
<td style="text-align: left;">Tells who received the grant (all = U of I)</td>
<td style="text-align: left;">Categorical</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Award Dollars</td>
<td style="text-align: left;">Award amount</td>
<td style="text-align: left;">Quantitative</td>
</tr>
<tr class="even">
<td style="text-align: left;">Program Name</td>
<td style="text-align: left;">Name of program grant will be used for (some are N/A)</td>
<td style="text-align: left;">Categorical</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Program Area Name</td>
<td style="text-align: left;">Name of program (some have N/A)</td>
<td style="text-align: left;">Categorical</td>
</tr>
</tbody>
</table>
<figcaption class="figure-caption">Figure&nbsp;1: USDAtoUI Data Dictionary</figcaption></figure>
</div>
</div>
<div class="cell">
<div id="fig-DOEDataDict" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><table class="table table-sm table-striped small">
<colgroup>
<col style="width: 11%">
<col style="width: 68%">
<col style="width: 6%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 6%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Attribute</th>
<th style="text-align: left;">Description</th>
<th style="text-align: left;">Type…3</th>
<th style="text-align: left;">…4</th>
<th style="text-align: left;">…5</th>
<th style="text-align: left;">…6</th>
<th style="text-align: left;">Type…7</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Award Number</td>
<td style="text-align: left;">ID of award</td>
<td style="text-align: left;">Item</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">Ordinal</td>
</tr>
<tr class="even">
<td style="text-align: left;">Title</td>
<td style="text-align: left;">Title of award</td>
<td style="text-align: left;">Item</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">Item</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Institution</td>
<td style="text-align: left;">Organization to whom award was granted. Some are universities, but others are companies and laboratories (many are included, not just U of I)</td>
<td style="text-align: left;">Item</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">Ordinal</td>
</tr>
<tr class="even">
<td style="text-align: left;">City</td>
<td style="text-align: left;">City of that organization (many- not restricted to Moscow)</td>
<td style="text-align: left;">Item</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">Ordinal</td>
</tr>
<tr class="odd">
<td style="text-align: left;">State</td>
<td style="text-align: left;">State of that organization (many, not restricted to ID)</td>
<td style="text-align: left;">Item</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">Ordinal</td>
</tr>
<tr class="even">
<td style="text-align: left;">Zip Code</td>
<td style="text-align: left;">Zipcode of that organization</td>
<td style="text-align: left;">Item</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">Quantitative</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PI</td>
<td style="text-align: left;">Principle Investigator to whom award was granted</td>
<td style="text-align: left;">Item</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">Quantitative</td>
</tr>
<tr class="even">
<td style="text-align: left;">Status</td>
<td style="text-align: left;">Tells if award is ongoing or not (seems that only active/current awards are included in this data set)</td>
<td style="text-align: left;">Categorical</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">Categorical</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Action Type</td>
<td style="text-align: left;">Tells if the award is new or a renewal</td>
<td style="text-align: left;">Categorical</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">Item</td>
</tr>
<tr class="even">
<td style="text-align: left;">Org Code</td>
<td style="text-align: left;">Unique code for the award</td>
<td style="text-align: left;">Item</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">Ordinal</td>
</tr>
<tr class="odd">
<td style="text-align: left;">SBIR/STTR</td>
<td style="text-align: left;">Tells if the awards are SBIR (Small Business Innovation Research) or STTR (Small Business Technology Transfer) programs. Neither = N/A</td>
<td style="text-align: left;">Categorical</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">Quantitative</td>
</tr>
<tr class="even">
<td style="text-align: left;">Program Office</td>
<td style="text-align: left;">Tells what DOE program office oversees the award</td>
<td style="text-align: left;">Categorical</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Award Type</td>
<td style="text-align: left;">Tells type of award (grant, interagency agreement, cooperative agreement)</td>
<td style="text-align: left;">Categorical</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">PM</td>
<td style="text-align: left;">Project Manager (appear to be different people than PI)</td>
<td style="text-align: left;">Item</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Start Date</td>
<td style="text-align: left;">Award start date</td>
<td style="text-align: left;">Ordinal</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">End Date</td>
<td style="text-align: left;">Award end date</td>
<td style="text-align: left;">Ordinal</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">SBIR Phase</td>
<td style="text-align: left;">If applicable, phase of SBIR</td>
<td style="text-align: left;">Categorical</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">Most Recent Award Date</td>
<td style="text-align: left;">Date of most recent award</td>
<td style="text-align: left;">Ordinal</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Amount Awarded to Date</td>
<td style="text-align: left;">Money given as of most recent award date</td>
<td style="text-align: left;">Quantitative</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">Amount Awarded this FY</td>
<td style="text-align: left;">Amount awarded this fiscal year</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Program Area</td>
<td style="text-align: left;">What type of program the award will be used towards</td>
<td style="text-align: left;">Item</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">Register Number</td>
<td style="text-align: left;">Unique code for the award</td>
<td style="text-align: left;">Item</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">UEI</td>
<td style="text-align: left;">Unique code for the award</td>
<td style="text-align: left;">Item</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">DUNS</td>
<td style="text-align: left;">Unique code for the award</td>
<td style="text-align: left;">Item</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Institution Type</td>
<td style="text-align: left;">Type of institution that has received the award</td>
<td style="text-align: left;">Categorical</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">Abstract</td>
<td style="text-align: left;">Abstract of what award is proposed to be used for</td>
<td style="text-align: left;">Item</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
</tbody>
</table>
<figcaption class="figure-caption">Figure&nbsp;2: DOE Data Dictionary</figcaption></figure>
</div>
</div>
<div class="cell">
<div id="fig-project_dfDataDict" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><table class="table table-sm table-striped small">
<colgroup>
<col style="width: 27%">
<col style="width: 63%">
<col style="width: 9%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Attribute</th>
<th style="text-align: left;">Description</th>
<th style="text-align: left;">Type</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">appl id</td>
<td style="text-align: left;">Unique ID</td>
<td style="text-align: left;">Item</td>
</tr>
<tr class="even">
<td style="text-align: left;">subproject id</td>
<td style="text-align: left;">Some awards have subproject unique ID values</td>
<td style="text-align: left;">Item</td>
</tr>
<tr class="odd">
<td style="text-align: left;">fiscal year</td>
<td style="text-align: left;">Year of award</td>
<td style="text-align: left;">Ordinal</td>
</tr>
<tr class="even">
<td style="text-align: left;">project num</td>
<td style="text-align: left;">Project number (seems to be a grouping variable)</td>
<td style="text-align: left;">Categorical</td>
</tr>
<tr class="odd">
<td style="text-align: left;">project serial num</td>
<td style="text-align: left;">Project number (seems to be a grouping variable)</td>
<td style="text-align: left;">Categorical</td>
</tr>
<tr class="even">
<td style="text-align: left;">award type</td>
<td style="text-align: left;">Type of award (1, 2, 3, 4, 4N, 5)</td>
<td style="text-align: left;">Categorical</td>
</tr>
<tr class="odd">
<td style="text-align: left;">activity code</td>
<td style="text-align: left;">Code for award</td>
<td style="text-align: left;">Categorical</td>
</tr>
<tr class="even">
<td style="text-align: left;">award amount</td>
<td style="text-align: left;">Amount alloted for award</td>
<td style="text-align: left;">Quantitative</td>
</tr>
<tr class="odd">
<td style="text-align: left;">is active</td>
<td style="text-align: left;">Tells whether the award is ongoing or not (TRUE/FALSE)</td>
<td style="text-align: left;">Categorical</td>
</tr>
<tr class="even">
<td style="text-align: left;">principal investigators</td>
<td style="text-align: left;">No values</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">contact pi name</td>
<td style="text-align: left;">Names of PIs</td>
<td style="text-align: left;">Item</td>
</tr>
<tr class="even">
<td style="text-align: left;">program officers</td>
<td style="text-align: left;">No values</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">agency ic fundings</td>
<td style="text-align: left;">No values/unsure</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">cong dist</td>
<td style="text-align: left;">Appears to be a subset of code for awards</td>
<td style="text-align: left;">Categorical</td>
</tr>
<tr class="odd">
<td style="text-align: left;">spending categories</td>
<td style="text-align: left;">No values</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">project start date</td>
<td style="text-align: left;">Start date</td>
<td style="text-align: left;">Ordinal</td>
</tr>
<tr class="odd">
<td style="text-align: left;">project end date</td>
<td style="text-align: left;">End date</td>
<td style="text-align: left;">Ordinal</td>
</tr>
<tr class="even">
<td style="text-align: left;">opportunity number</td>
<td style="text-align: left;">Appears to be a subset of code for awards</td>
<td style="text-align: left;">Categorical</td>
</tr>
<tr class="odd">
<td style="text-align: left;">award notice date</td>
<td style="text-align: left;">Date of notification of award</td>
<td style="text-align: left;">Ordinal</td>
</tr>
<tr class="even">
<td style="text-align: left;">is new</td>
<td style="text-align: left;">Tells whether the award is new or not (TRUE/FALSE)</td>
<td style="text-align: left;">Categorical</td>
</tr>
<tr class="odd">
<td style="text-align: left;">mechanism code dc</td>
<td style="text-align: left;">Code for mechanism</td>
<td style="text-align: left;">Categorical</td>
</tr>
<tr class="even">
<td style="text-align: left;">core project num</td>
<td style="text-align: left;">ID for award</td>
<td style="text-align: left;">Item</td>
</tr>
<tr class="odd">
<td style="text-align: left;">terms</td>
<td style="text-align: left;">Keywords grant proposes to address with award</td>
<td style="text-align: left;">Item</td>
</tr>
<tr class="even">
<td style="text-align: left;">pref terms</td>
<td style="text-align: left;">Preferred keywords</td>
<td style="text-align: left;">Item</td>
</tr>
<tr class="odd">
<td style="text-align: left;">abstract text</td>
<td style="text-align: left;">Abstract</td>
<td style="text-align: left;">Item</td>
</tr>
<tr class="even">
<td style="text-align: left;">project title</td>
<td style="text-align: left;">Title of project</td>
<td style="text-align: left;">Item</td>
</tr>
<tr class="odd">
<td style="text-align: left;">phr text</td>
<td style="text-align: left;">Some awards have project narrative text</td>
<td style="text-align: left;">Item</td>
</tr>
<tr class="even">
<td style="text-align: left;">spending categories desc</td>
<td style="text-align: left;">Some awards have spending categories</td>
<td style="text-align: left;">Item</td>
</tr>
<tr class="odd">
<td style="text-align: left;">agency code</td>
<td style="text-align: left;">All = NIH</td>
<td style="text-align: left;">Categorical</td>
</tr>
<tr class="even">
<td style="text-align: left;">covid response</td>
<td style="text-align: left;">No values/unsure</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">arra funded</td>
<td style="text-align: left;">All = N</td>
<td style="text-align: left;">Categorical</td>
</tr>
<tr class="even">
<td style="text-align: left;">budget start</td>
<td style="text-align: left;">Start date of budget</td>
<td style="text-align: left;">Ordinal</td>
</tr>
<tr class="odd">
<td style="text-align: left;">budget end</td>
<td style="text-align: left;">End date of budget</td>
<td style="text-align: left;">Ordinal</td>
</tr>
<tr class="even">
<td style="text-align: left;">cfda code</td>
<td style="text-align: left;">Number assigned in the awarding document funded by the Federal government (similar to NSF)</td>
<td style="text-align: left;">Item</td>
</tr>
<tr class="odd">
<td style="text-align: left;">funding mechanism</td>
<td style="text-align: left;">Mechanism for funding (similar to DOE)</td>
<td style="text-align: left;">Categorical</td>
</tr>
<tr class="even">
<td style="text-align: left;">direct cost amt</td>
<td style="text-align: left;">Cost directly of award</td>
<td style="text-align: left;">Quantitative</td>
</tr>
<tr class="odd">
<td style="text-align: left;">indirect cost amt</td>
<td style="text-align: left;">Cost indirectly of award</td>
<td style="text-align: left;">Quantitative</td>
</tr>
<tr class="even">
<td style="text-align: left;">project detail url</td>
<td style="text-align: left;">Website of project details</td>
<td style="text-align: left;">Item</td>
</tr>
<tr class="odd">
<td style="text-align: left;">date added</td>
<td style="text-align: left;">Date award added</td>
<td style="text-align: left;">Ordinal</td>
</tr>
<tr class="even">
<td style="text-align: left;">organization org name</td>
<td style="text-align: left;">Organization of awardee (either U of I or BSU)</td>
<td style="text-align: left;">Categorical</td>
</tr>
<tr class="odd">
<td style="text-align: left;">organization city</td>
<td style="text-align: left;">No values/unsure</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">organization country</td>
<td style="text-align: left;">No values/unsure</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">organization org city</td>
<td style="text-align: left;">City of University (either Moscow or Boise)</td>
<td style="text-align: left;">Categorical</td>
</tr>
<tr class="even">
<td style="text-align: left;">organization org country</td>
<td style="text-align: left;">Country = USA</td>
<td style="text-align: left;">Categorical</td>
</tr>
<tr class="odd">
<td style="text-align: left;">organization org state</td>
<td style="text-align: left;">State = ID</td>
<td style="text-align: left;">Categorical</td>
</tr>
<tr class="even">
<td style="text-align: left;">organization org state name</td>
<td style="text-align: left;">No values</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">organization dept type</td>
<td style="text-align: left;">Department type being awarded (some have)</td>
<td style="text-align: left;">Categorical</td>
</tr>
<tr class="even">
<td style="text-align: left;">organization fips country code</td>
<td style="text-align: left;">No values</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">organization org duns</td>
<td style="text-align: left;">No values</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">organization org ueis</td>
<td style="text-align: left;">No values</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">organization primary duns</td>
<td style="text-align: left;">Seems to be some grouping variable</td>
<td style="text-align: left;">Categorical</td>
</tr>
<tr class="even">
<td style="text-align: left;">organization primary uei</td>
<td style="text-align: left;">Seems to be some grouping variable</td>
<td style="text-align: left;">Categorical</td>
</tr>
<tr class="odd">
<td style="text-align: left;">organization org fips</td>
<td style="text-align: left;">All = US</td>
<td style="text-align: left;">Categorical</td>
</tr>
<tr class="even">
<td style="text-align: left;">organization org ipf code</td>
<td style="text-align: left;">Seems to be some grouping variable</td>
<td style="text-align: left;">Categorical</td>
</tr>
<tr class="odd">
<td style="text-align: left;">organization org zipcode</td>
<td style="text-align: left;">Zipcode of organization</td>
<td style="text-align: left;">Categorical</td>
</tr>
<tr class="even">
<td style="text-align: left;">organization external org id</td>
<td style="text-align: left;">Seems to be some grouping variable</td>
<td style="text-align: left;">Categorical</td>
</tr>
<tr class="odd">
<td style="text-align: left;">project num split appl type code</td>
<td style="text-align: left;">Seems to be values 1-10</td>
<td style="text-align: left;">Categorical</td>
</tr>
<tr class="even">
<td style="text-align: left;">project num split activity code</td>
<td style="text-align: left;">Seems to be some grouping variable</td>
<td style="text-align: left;">Categorical</td>
</tr>
<tr class="odd">
<td style="text-align: left;">project num split ic code</td>
<td style="text-align: left;">Seems to be some grouping variable</td>
<td style="text-align: left;">Categorical</td>
</tr>
<tr class="even">
<td style="text-align: left;">project num split serial num</td>
<td style="text-align: left;">Seems to be some grouping variable</td>
<td style="text-align: left;">Categorical</td>
</tr>
<tr class="odd">
<td style="text-align: left;">project num split support year</td>
<td style="text-align: left;">Not sure</td>
<td style="text-align: left;">Categorical</td>
</tr>
<tr class="even">
<td style="text-align: left;">project num split full support year</td>
<td style="text-align: left;">Similar to previous</td>
<td style="text-align: left;">Categorical</td>
</tr>
<tr class="odd">
<td style="text-align: left;">project num split suffix code</td>
<td style="text-align: left;">Not sure (only some values have)</td>
<td style="text-align: left;">Categorical</td>
</tr>
<tr class="even">
<td style="text-align: left;">agency ic admin code</td>
<td style="text-align: left;">Appears to be the same as project_num_split.ic_code</td>
<td style="text-align: left;">Categorical</td>
</tr>
<tr class="odd">
<td style="text-align: left;">agency ic admin abbreviation</td>
<td style="text-align: left;">Some sort of abbreviation</td>
<td style="text-align: left;">Categorical</td>
</tr>
<tr class="even">
<td style="text-align: left;">agency ic admin name</td>
<td style="text-align: left;">Agency name (health related)</td>
<td style="text-align: left;">Categorical</td>
</tr>
<tr class="odd">
<td style="text-align: left;">organization type name</td>
<td style="text-align: left;">Type of organization</td>
<td style="text-align: left;">Categorical</td>
</tr>
<tr class="even">
<td style="text-align: left;">organization type code</td>
<td style="text-align: left;">All = 10</td>
<td style="text-align: left;">Categorical</td>
</tr>
<tr class="odd">
<td style="text-align: left;">organization type is other</td>
<td style="text-align: left;">Extends organization type (TRUE/FALSE)</td>
<td style="text-align: left;">Categorical</td>
</tr>
<tr class="even">
<td style="text-align: left;">full study section srg code</td>
<td style="text-align: left;">Seems to be some grouping variable</td>
<td style="text-align: left;">Categorical</td>
</tr>
<tr class="odd">
<td style="text-align: left;">full study section srg flex</td>
<td style="text-align: left;">Unsure (only some values have)</td>
<td style="text-align: left;">Categorical</td>
</tr>
<tr class="even">
<td style="text-align: left;">full study section sra designator code</td>
<td style="text-align: left;">Some sort of grouping variable code</td>
<td style="text-align: left;">Categorical</td>
</tr>
<tr class="odd">
<td style="text-align: left;">full study section sra flex code</td>
<td style="text-align: left;">Unsure (some have letters, some numbers)</td>
<td style="text-align: left;">Categorical</td>
</tr>
<tr class="even">
<td style="text-align: left;">full study section group code</td>
<td style="text-align: left;">Some sort of grouping code</td>
<td style="text-align: left;">Categorical</td>
</tr>
<tr class="odd">
<td style="text-align: left;">full study section name</td>
<td style="text-align: left;">Section name</td>
<td style="text-align: left;">Categorical</td>
</tr>
</tbody>
</table>
<figcaption class="figure-caption">Figure&nbsp;3: project_df Data Dictionary</figcaption></figure>
</div>
</div>
<div class="cell">
<div id="fig-NSFtoUIDataDict" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><table class="table table-sm table-striped small">
<colgroup>
<col style="width: 20%">
<col style="width: 67%">
<col style="width: 11%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Attribute</th>
<th style="text-align: left;">Description</th>
<th style="text-align: left;">Type</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">abstractText</td>
<td style="text-align: left;">Text of abstract</td>
<td style="text-align: left;">Item</td>
</tr>
<tr class="even">
<td style="text-align: left;">agency</td>
<td style="text-align: left;">Agency awarding (for all = NSF)</td>
<td style="text-align: left;">Categorical</td>
</tr>
<tr class="odd">
<td style="text-align: left;">awardAgencyCode</td>
<td style="text-align: left;">All NSF codes appear to be 4900</td>
<td style="text-align: left;">Categorical</td>
</tr>
<tr class="even">
<td style="text-align: left;">awardeeAddress</td>
<td style="text-align: left;">Address of awardee (all of these = U of I)</td>
<td style="text-align: left;">Item</td>
</tr>
<tr class="odd">
<td style="text-align: left;">awardeeCity</td>
<td style="text-align: left;">City of awardee</td>
<td style="text-align: left;">Item</td>
</tr>
<tr class="even">
<td style="text-align: left;">awardeeCountryCode</td>
<td style="text-align: left;">Country of awardee</td>
<td style="text-align: left;">Item</td>
</tr>
<tr class="odd">
<td style="text-align: left;">awardeeDistrictCode</td>
<td style="text-align: left;">District code of awardee (all = ID01)</td>
<td style="text-align: left;">Categorical</td>
</tr>
<tr class="even">
<td style="text-align: left;">awardeeName</td>
<td style="text-align: left;">Name of awardee (all = Regents of U of I)</td>
<td style="text-align: left;">Item</td>
</tr>
<tr class="odd">
<td style="text-align: left;">awardeeStateCode</td>
<td style="text-align: left;">State of awardee</td>
<td style="text-align: left;">Item</td>
</tr>
<tr class="even">
<td style="text-align: left;">awardeeZipCode</td>
<td style="text-align: left;">Zip code of awardee</td>
<td style="text-align: left;">Item</td>
</tr>
<tr class="odd">
<td style="text-align: left;">cfdaNumber</td>
<td style="text-align: left;">Number assigned in the awarding document funded by the Federal government</td>
<td style="text-align: left;">Item</td>
</tr>
<tr class="even">
<td style="text-align: left;">coPDPI</td>
<td style="text-align: left;">Unsure/no values</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ueiNumber</td>
<td style="text-align: left;">Code given to U of I awards (all are the same in this data set)</td>
<td style="text-align: left;">Item</td>
</tr>
<tr class="even">
<td style="text-align: left;">estimatedTotalAmt</td>
<td style="text-align: left;">Estimated total amount of award</td>
<td style="text-align: left;">Quantitative</td>
</tr>
<tr class="odd">
<td style="text-align: left;">fundsObligatedAmt</td>
<td style="text-align: left;">Amount NSF is obligated to give</td>
<td style="text-align: left;">Quantitative</td>
</tr>
<tr class="even">
<td style="text-align: left;">fundAgencyCode</td>
<td style="text-align: left;">Same code as above awardAgencyCode</td>
<td style="text-align: left;">Categorical</td>
</tr>
<tr class="odd">
<td style="text-align: left;">fundProgramName</td>
<td style="text-align: left;">Various program names</td>
<td style="text-align: left;">Item</td>
</tr>
<tr class="even">
<td style="text-align: left;">id</td>
<td style="text-align: left;">Unique ID for each award</td>
<td style="text-align: left;">Item</td>
</tr>
<tr class="odd">
<td style="text-align: left;">parentUeiNumber</td>
<td style="text-align: left;">Unsure/no values</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">pdPIName</td>
<td style="text-align: left;">Principle Investigator</td>
<td style="text-align: left;">Item</td>
</tr>
<tr class="odd">
<td style="text-align: left;">perfAddress</td>
<td style="text-align: left;">Preferred address of awardee (most are U of I, some elsewhere)</td>
<td style="text-align: left;">Item</td>
</tr>
<tr class="even">
<td style="text-align: left;">perfCity</td>
<td style="text-align: left;">Preferred city</td>
<td style="text-align: left;">Item</td>
</tr>
<tr class="odd">
<td style="text-align: left;">perfCountryCode</td>
<td style="text-align: left;">Preferred country code</td>
<td style="text-align: left;">Item</td>
</tr>
<tr class="even">
<td style="text-align: left;">perfDistrictCode</td>
<td style="text-align: left;">Preferred discrict code</td>
<td style="text-align: left;">Item</td>
</tr>
<tr class="odd">
<td style="text-align: left;">perfLocation</td>
<td style="text-align: left;">Preferred location (some prefer elsewhere- like Idaho Falls)</td>
<td style="text-align: left;">Item</td>
</tr>
<tr class="even">
<td style="text-align: left;">perfStateCode</td>
<td style="text-align: left;">Preferred state code</td>
<td style="text-align: left;">Item</td>
</tr>
<tr class="odd">
<td style="text-align: left;">perfZipCode</td>
<td style="text-align: left;">Preferred zip code</td>
<td style="text-align: left;">Item</td>
</tr>
<tr class="even">
<td style="text-align: left;">piEmail</td>
<td style="text-align: left;">Email of PI</td>
<td style="text-align: left;">Item</td>
</tr>
<tr class="odd">
<td style="text-align: left;">piFirstName</td>
<td style="text-align: left;">First name of PI</td>
<td style="text-align: left;">Item</td>
</tr>
<tr class="even">
<td style="text-align: left;">piLastName</td>
<td style="text-align: left;">Last name of PI</td>
<td style="text-align: left;">Item</td>
</tr>
<tr class="odd">
<td style="text-align: left;">piMiddeInitial</td>
<td style="text-align: left;">Middle initial of PI</td>
<td style="text-align: left;">Item</td>
</tr>
<tr class="even">
<td style="text-align: left;">poEmail</td>
<td style="text-align: left;">Email of Program Officer</td>
<td style="text-align: left;">Item</td>
</tr>
<tr class="odd">
<td style="text-align: left;">poName</td>
<td style="text-align: left;">Name of Program Officer</td>
<td style="text-align: left;">Item</td>
</tr>
<tr class="even">
<td style="text-align: left;">poPhone</td>
<td style="text-align: left;">Phone of PO</td>
<td style="text-align: left;">Item</td>
</tr>
<tr class="odd">
<td style="text-align: left;">primaryProgram</td>
<td style="text-align: left;">Unsure/no values</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">date</td>
<td style="text-align: left;">Current data?</td>
<td style="text-align: left;">Ordinal</td>
</tr>
<tr class="odd">
<td style="text-align: left;">startDate</td>
<td style="text-align: left;">Start date of award</td>
<td style="text-align: left;">Ordinal</td>
</tr>
<tr class="even">
<td style="text-align: left;">expDate</td>
<td style="text-align: left;">End data of award</td>
<td style="text-align: left;">Ordinal</td>
</tr>
<tr class="odd">
<td style="text-align: left;">title</td>
<td style="text-align: left;">Title of award</td>
<td style="text-align: left;">Item</td>
</tr>
<tr class="even">
<td style="text-align: left;">transType</td>
<td style="text-align: left;">Type of grant (continuing, standard, fellowship…)</td>
<td style="text-align: left;">Categorical</td>
</tr>
<tr class="odd">
<td style="text-align: left;">awardee</td>
<td style="text-align: left;">Again, here = regents of U of I for all</td>
<td style="text-align: left;">Item</td>
</tr>
<tr class="even">
<td style="text-align: left;">publicationResearch</td>
<td style="text-align: left;">Unsure/no values</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">projectOutComesReport</td>
<td style="text-align: left;">Some have a snippet on the findings thus far</td>
<td style="text-align: left;">Item</td>
</tr>
</tbody>
</table>
<figcaption class="figure-caption">Figure&nbsp;4: NSF to UI Data Dictionary</figcaption></figure>
</div>
</div>


<!-- -->

</section></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb2" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "BCB 520 - Midterm Portfolio Post"</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="an">subtitle:</span><span class="co"> "Evaluating Awards and Grants: UI vs. Others"</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Heidi Sellmann"</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "2024-03-11"</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="an">categories:</span><span class="co"> [Assignment, DataViz, Tables, Project]</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="an">image:</span><span class="co"> "grants.jpg"</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="an">code-fold:</span><span class="co"> true</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="an">code-tools:</span><span class="co"> true</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="an">code-link:</span><span class="co"> true</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="an">description:</span><span class="co"> "Grants and awards and bears, oh my!"</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span><span class="co"> </span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="co">    css: styles.css</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="an">editor:</span><span class="co"> </span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="co">  markdown: </span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="co">    wrap: 72</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">echo=</span><span class="cn">FALSE</span>, <span class="at">warning=</span><span class="cn">FALSE</span>, <span class="at">error=</span><span class="cn">FALSE</span>, <span class="at">message=</span><span class="cn">FALSE</span>)</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a><span class="fu"># PREAMBLE</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>In this assignment I will be evaluating award/grant data from four federal sponsors: The</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>National Science Foundation (NSF), The National Institutes of Health</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>(NIH), The Department of Energy (DOE), and The US Department of</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>Agriculture (USDA).</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a><span class="fu"># DATA</span></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Load libraries, warning = FALSE}</span></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(httr)</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(jsonlite)</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>**1. Department of Agriculture (NIFA)** See the data dictionary here</span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>@fig-USDAtoUIDataDict. This includes agricultural related grants all the</span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>way from the early 2000s.</span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a><span class="in">```{r USDAtoUI, echo = FALSE}</span></span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>USDAtoUI<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">"USDAtoUI.csv"</span>)</span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a><span class="co"># knitr::kable(head(USDAtoUI))</span></span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a>**2. Department of Energy (DOE)** The data dictionary for this extensive data set can be accessed here</span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a>@fig-DOEDataDict. This data is not restricted to a particular award</span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a>recipient.</span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a><span class="in">```{r DOE awards, message = FALSE, echo=FALSE}</span></span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a>DOEawards<span class="ot">&lt;-</span><span class="fu">read_excel</span>(<span class="st">"DOEawards.xlsx"</span>)</span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a><span class="co">#knitr::kable(head(DOEawards))</span></span>
<span id="cb2-60"><a href="#cb2-60" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb2-61"><a href="#cb2-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-62"><a href="#cb2-62" aria-hidden="true" tabindex="-1"></a>**3. National Institutes of Health (NIH)** This data can be obtained</span>
<span id="cb2-63"><a href="#cb2-63" aria-hidden="true" tabindex="-1"></a>from an Application Programming Interface (API). You can access this data's dictionary here @fig-project_dfDataDict. This</span>
<span id="cb2-64"><a href="#cb2-64" aria-hidden="true" tabindex="-1"></a>is quite a large data set with information on awards (related to health</span>
<span id="cb2-65"><a href="#cb2-65" aria-hidden="true" tabindex="-1"></a>sciences) recieved by BSU and U of I between 2013-2024. Of note, this is</span>
<span id="cb2-66"><a href="#cb2-66" aria-hidden="true" tabindex="-1"></a>an example of heirarchal data- some cells appear to have no values in</span>
<span id="cb2-67"><a href="#cb2-67" aria-hidden="true" tabindex="-1"></a>them becuase there are actually multiple variables within those cells.</span>
<span id="cb2-68"><a href="#cb2-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-69"><a href="#cb2-69" aria-hidden="true" tabindex="-1"></a><span class="in">```{r NIH API}</span></span>
<span id="cb2-70"><a href="#cb2-70" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the base URL for the API</span></span>
<span id="cb2-71"><a href="#cb2-71" aria-hidden="true" tabindex="-1"></a>base_url <span class="ot">&lt;-</span> <span class="st">"https://api.reporter.nih.gov/v2/projects/search"</span></span>
<span id="cb2-72"><a href="#cb2-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-73"><a href="#cb2-73" aria-hidden="true" tabindex="-1"></a><span class="co"># This omits the `include_fields` option and downloads all the data for the University of Idaho and Boise State University from Fiscal Year 2013 to Fiscal Year 2024.</span></span>
<span id="cb2-74"><a href="#cb2-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-75"><a href="#cb2-75" aria-hidden="true" tabindex="-1"></a><span class="co"># Build query parameters</span></span>
<span id="cb2-76"><a href="#cb2-76" aria-hidden="true" tabindex="-1"></a>query_params <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb2-77"><a href="#cb2-77" aria-hidden="true" tabindex="-1"></a>  <span class="at">criteria =</span> <span class="fu">list</span>(</span>
<span id="cb2-78"><a href="#cb2-78" aria-hidden="true" tabindex="-1"></a>    <span class="at">fiscal_years =</span> <span class="dv">2013</span><span class="sc">:</span><span class="dv">2024</span>, <span class="co"># Specify range of fiscal years</span></span>
<span id="cb2-79"><a href="#cb2-79" aria-hidden="true" tabindex="-1"></a>    <span class="at">org_names =</span> <span class="fu">list</span>(<span class="st">"UNIVERSITY OF IDAHO"</span>, <span class="st">"BOISE STATE UNIVERSITY"</span>)),</span>
<span id="cb2-80"><a href="#cb2-80" aria-hidden="true" tabindex="-1"></a>  <span class="at">offset =</span> <span class="dv">0</span>, <span class="co"># Starting point for fetching results.  Unlikely you'd ever want to change this.</span></span>
<span id="cb2-81"><a href="#cb2-81" aria-hidden="true" tabindex="-1"></a>  <span class="at">limit =</span> <span class="dv">500</span>, <span class="co"># Maximum number of results to fetch. Sometimes the API sets a maximum.  NIH does not.</span></span>
<span id="cb2-82"><a href="#cb2-82" aria-hidden="true" tabindex="-1"></a>  <span class="at">sort_field =</span> <span class="st">"ProjectStartDate"</span>, <span class="co"># Field to sort by.  Largely irrelevant as our visualizations should control this.</span></span>
<span id="cb2-83"><a href="#cb2-83" aria-hidden="true" tabindex="-1"></a>  <span class="at">sort_order =</span> <span class="st">"desc"</span> <span class="co"># Sort order</span></span>
<span id="cb2-84"><a href="#cb2-84" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-85"><a href="#cb2-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-86"><a href="#cb2-86" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert query parameters to JSON format. This part is tricky.  This line converts the list above to a format (json) that the API will recognize.  This is a place where Python is way better than R.</span></span>
<span id="cb2-87"><a href="#cb2-87" aria-hidden="true" tabindex="-1"></a>query_json <span class="ot">&lt;-</span> <span class="fu">toJSON</span>(query_params, <span class="at">auto_unbox =</span> <span class="cn">TRUE</span>, <span class="at">null =</span> <span class="st">"null"</span>, <span class="at">pretty =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-88"><a href="#cb2-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-89"><a href="#cb2-89" aria-hidden="true" tabindex="-1"></a><span class="co"># Set header information for the request.  Some instructions to the API about our query.</span></span>
<span id="cb2-90"><a href="#cb2-90" aria-hidden="true" tabindex="-1"></a>headers <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Content-Type"</span> <span class="ot">=</span> <span class="st">"application/json"</span>)</span>
<span id="cb2-91"><a href="#cb2-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-92"><a href="#cb2-92" aria-hidden="true" tabindex="-1"></a><span class="co"># Send a POST request and retrieve response data.  POST is just a type of API interaction.  response is a json object.  Click on it in your environment to see the hierarchical structure.</span></span>
<span id="cb2-93"><a href="#cb2-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-94"><a href="#cb2-94" aria-hidden="true" tabindex="-1"></a>response <span class="ot">&lt;-</span> <span class="fu">POST</span>(base_url, <span class="at">body =</span> query_json, <span class="at">encode =</span> <span class="st">"json"</span>, httr<span class="sc">::</span><span class="fu">add_headers</span>(<span class="at">.headers =</span> headers))</span>
<span id="cb2-95"><a href="#cb2-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-96"><a href="#cb2-96" aria-hidden="true" tabindex="-1"></a><span class="co"># Check if the request was successful.  Sometimes the error is from our code.  But sometimes it is from the API call.  Status codes help us figure out where any problems might be.</span></span>
<span id="cb2-97"><a href="#cb2-97" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">status_code</span>(response) <span class="sc">==</span> <span class="dv">200</span>) {</span>
<span id="cb2-98"><a href="#cb2-98" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract and parse JSON data</span></span>
<span id="cb2-99"><a href="#cb2-99" aria-hidden="true" tabindex="-1"></a>  json_data_NIH <span class="ot">&lt;-</span> <span class="fu">content</span>(response, <span class="at">as =</span> <span class="st">"text"</span>, <span class="at">encoding =</span> <span class="st">"UTF-8"</span>)</span>
<span id="cb2-100"><a href="#cb2-100" aria-hidden="true" tabindex="-1"></a>  parsed_data_NIH <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(json_data_NIH, <span class="at">flatten =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-101"><a href="#cb2-101" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-102"><a href="#cb2-102" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Select columns based on the actual JSON data structure. The data frame (technically the tibble) we want is in the results component.  click on parsed_data and you'll see what I mean.</span></span>
<span id="cb2-103"><a href="#cb2-103" aria-hidden="true" tabindex="-1"></a>  projects_df <span class="ot">&lt;-</span> parsed_data_NIH<span class="sc">$</span>results</span>
<span id="cb2-104"><a href="#cb2-104" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-105"><a href="#cb2-105" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-106"><a href="#cb2-106" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Print the data frame.  This is nice for debugging but you'll eventually want to stop doing this.</span></span>
<span id="cb2-107"><a href="#cb2-107" aria-hidden="true" tabindex="-1"></a>  <span class="co"># print(projects_df)</span></span>
<span id="cb2-108"><a href="#cb2-108" aria-hidden="true" tabindex="-1"></a>  <span class="co"># knitr::kable(head(projects_df))</span></span>
<span id="cb2-109"><a href="#cb2-109" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb2-110"><a href="#cb2-110" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Print an error message if data fetching failed</span></span>
<span id="cb2-111"><a href="#cb2-111" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Failed to fetch data: Status code"</span>, <span class="fu">status_code</span>(response)))</span>
<span id="cb2-112"><a href="#cb2-112" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Print the full response for debugging purposes</span></span>
<span id="cb2-113"><a href="#cb2-113" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">content</span>(response, <span class="at">as =</span> <span class="st">"text"</span>))</span>
<span id="cb2-114"><a href="#cb2-114" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-115"><a href="#cb2-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-116"><a href="#cb2-116" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb2-117"><a href="#cb2-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-118"><a href="#cb2-118" aria-hidden="true" tabindex="-1"></a>**4. National Science Foundation (NSF)** The NSF also has an API, and</span>
<span id="cb2-119"><a href="#cb2-119" aria-hidden="true" tabindex="-1"></a>the following code pulled down awards to the University of Idaho into a</span>
<span id="cb2-120"><a href="#cb2-120" aria-hidden="true" tabindex="-1"></a>data frame called NSFtoUI. See the data dictionary here @fig-NSFtoUIDataDict. Briefly, this data</span>
<span id="cb2-121"><a href="#cb2-121" aria-hidden="true" tabindex="-1"></a>set gives information on NSF grants awarded to the University of Idaho</span>
<span id="cb2-122"><a href="#cb2-122" aria-hidden="true" tabindex="-1"></a>from 1975 to current day.</span>
<span id="cb2-123"><a href="#cb2-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-124"><a href="#cb2-124" aria-hidden="true" tabindex="-1"></a><span class="in">```{r NSFtoUI load, eval = FALSE, message=FALSE}</span></span>
<span id="cb2-125"><a href="#cb2-125" aria-hidden="true" tabindex="-1"></a><span class="co"># Base URL for the API</span></span>
<span id="cb2-126"><a href="#cb2-126" aria-hidden="true" tabindex="-1"></a>base_url <span class="ot">&lt;-</span> <span class="st">"https://www.research.gov/awardapi-service/v1/awards.json?awardeeName=%22regents+of+the+university+of+idaho%22"</span></span>
<span id="cb2-127"><a href="#cb2-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-128"><a href="#cb2-128" aria-hidden="true" tabindex="-1"></a>printFields <span class="ot">&lt;-</span> <span class="st">"rpp,offset,id,agency,awardeeCity,awardeeCountryCode,awardeeDistrictCode,awardeeName,awardeeStateCode,awardeeZipCode,cfdaNumber,coPDPI,date,startDate,expDate,estimatedTotalAmt,fundsObligatedAmt,ueiNumber,fundProgramName,parentUeiNumber,pdPIName,perfCity,perfCountryCode,perfDistrictCode,perfLocation,perfStateCode,perfZipCode,poName,primaryProgram,transType,title,awardee,poPhone,poEmail,awardeeAddress,perfAddress,publicationResearch,publicationConference,fundAgencyCode,awardAgencyCode,projectOutComesReport,abstractText,piFirstName,piMiddeInitial,piLastName,piEmail"</span></span>
<span id="cb2-129"><a href="#cb2-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-130"><a href="#cb2-130" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize an empty data frame to store results</span></span>
<span id="cb2-131"><a href="#cb2-131" aria-hidden="true" tabindex="-1"></a>NSFtoUI <span class="ot">&lt;-</span> <span class="fu">tibble</span>()</span>
<span id="cb2-132"><a href="#cb2-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-133"><a href="#cb2-133" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of results per page (as per API settings)</span></span>
<span id="cb2-134"><a href="#cb2-134" aria-hidden="true" tabindex="-1"></a>results_per_page <span class="ot">&lt;-</span> <span class="dv">25</span></span>
<span id="cb2-135"><a href="#cb2-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-136"><a href="#cb2-136" aria-hidden="true" tabindex="-1"></a><span class="co"># Variable to keep track of the current page number</span></span>
<span id="cb2-137"><a href="#cb2-137" aria-hidden="true" tabindex="-1"></a>current_page <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb2-138"><a href="#cb2-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-139"><a href="#cb2-139" aria-hidden="true" tabindex="-1"></a><span class="co"># Variable to control the loop</span></span>
<span id="cb2-140"><a href="#cb2-140" aria-hidden="true" tabindex="-1"></a>keep_going <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb2-141"><a href="#cb2-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-142"><a href="#cb2-142" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span>(keep_going) {</span>
<span id="cb2-143"><a href="#cb2-143" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate the offset for the current page</span></span>
<span id="cb2-144"><a href="#cb2-144" aria-hidden="true" tabindex="-1"></a>    offset <span class="ot">&lt;-</span> (current_page <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> results_per_page <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb2-145"><a href="#cb2-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-146"><a href="#cb2-146" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Construct the full URL with offset</span></span>
<span id="cb2-147"><a href="#cb2-147" aria-hidden="true" tabindex="-1"></a>    url <span class="ot">&lt;-</span> <span class="fu">paste0</span>(base_url, <span class="st">"&amp;offset="</span>, offset, <span class="st">"&amp;printFields="</span>, printFields)</span>
<span id="cb2-148"><a href="#cb2-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-149"><a href="#cb2-149" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Make the API call</span></span>
<span id="cb2-150"><a href="#cb2-150" aria-hidden="true" tabindex="-1"></a>    response <span class="ot">&lt;-</span> <span class="fu">GET</span>(url)</span>
<span id="cb2-151"><a href="#cb2-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-152"><a href="#cb2-152" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check if the call was successful</span></span>
<span id="cb2-153"><a href="#cb2-153" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">status_code</span>(response) <span class="sc">==</span> <span class="dv">200</span>) {</span>
<span id="cb2-154"><a href="#cb2-154" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Extract and parse the JSON data</span></span>
<span id="cb2-155"><a href="#cb2-155" aria-hidden="true" tabindex="-1"></a>        json_data_NSF <span class="ot">&lt;-</span> <span class="fu">content</span>(response, <span class="at">type =</span> <span class="st">"text"</span>, <span class="at">encoding =</span> <span class="st">"UTF-8"</span>)</span>
<span id="cb2-156"><a href="#cb2-156" aria-hidden="true" tabindex="-1"></a>        parsed_data_NSF <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(json_data_NSF, <span class="at">flatten =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-157"><a href="#cb2-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-158"><a href="#cb2-158" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Extract the 'award' data and add to the all_awards data frame</span></span>
<span id="cb2-159"><a href="#cb2-159" aria-hidden="true" tabindex="-1"></a>        awards_data <span class="ot">&lt;-</span> parsed_data_NSF<span class="sc">$</span>response<span class="sc">$</span>award</span>
<span id="cb2-160"><a href="#cb2-160" aria-hidden="true" tabindex="-1"></a>        NSFtoUI <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(NSFtoUI, <span class="fu">as_tibble</span>(awards_data))</span>
<span id="cb2-161"><a href="#cb2-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-162"><a href="#cb2-162" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Debug: Print the current page number and number of awards fetched</span></span>
<span id="cb2-163"><a href="#cb2-163" aria-hidden="true" tabindex="-1"></a>        <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Page:"</span>, current_page, <span class="st">"- Awards fetched:"</span>, <span class="fu">length</span>(awards_data<span class="sc">$</span>id)))</span>
<span id="cb2-164"><a href="#cb2-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-165"><a href="#cb2-165" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Check if the current page has less than results_per_page awards, then it's the last page</span></span>
<span id="cb2-166"><a href="#cb2-166" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="fu">length</span>(awards_data<span class="sc">$</span>id) <span class="sc">&lt;</span> results_per_page) {</span>
<span id="cb2-167"><a href="#cb2-167" aria-hidden="true" tabindex="-1"></a>            keep_going <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb2-168"><a href="#cb2-168" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> {</span>
<span id="cb2-169"><a href="#cb2-169" aria-hidden="true" tabindex="-1"></a>            current_page <span class="ot">&lt;-</span> current_page <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb2-170"><a href="#cb2-170" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb2-171"><a href="#cb2-171" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb2-172"><a href="#cb2-172" aria-hidden="true" tabindex="-1"></a>        <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Failed to fetch data: Status code"</span>, <span class="fu">status_code</span>(response)))</span>
<span id="cb2-173"><a href="#cb2-173" aria-hidden="true" tabindex="-1"></a>        keep_going <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb2-174"><a href="#cb2-174" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb2-175"><a href="#cb2-175" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-176"><a href="#cb2-176" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb2-177"><a href="#cb2-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-178"><a href="#cb2-178" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Excel and NSFtoUI, warning=FALSE}</span></span>
<span id="cb2-179"><a href="#cb2-179" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(writexl)</span>
<span id="cb2-180"><a href="#cb2-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-181"><a href="#cb2-181" aria-hidden="true" tabindex="-1"></a><span class="co"># Write data frame to Excel file</span></span>
<span id="cb2-182"><a href="#cb2-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-183"><a href="#cb2-183" aria-hidden="true" tabindex="-1"></a><span class="co"># write_xlsx(projects_df, "project_df")</span></span>
<span id="cb2-184"><a href="#cb2-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-185"><a href="#cb2-185" aria-hidden="true" tabindex="-1"></a><span class="co"># write_xlsx(NSFtoUI, "NSFtoUI.xlsx")</span></span>
<span id="cb2-186"><a href="#cb2-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-187"><a href="#cb2-187" aria-hidden="true" tabindex="-1"></a>NSFtoUI <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"NSFtoUI.xlsx"</span>)</span>
<span id="cb2-188"><a href="#cb2-188" aria-hidden="true" tabindex="-1"></a><span class="co">#knitr::kable(head(NSFtoUI))</span></span>
<span id="cb2-189"><a href="#cb2-189" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb2-190"><a href="#cb2-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-191"><a href="#cb2-191" aria-hidden="true" tabindex="-1"></a><span class="fu"># QUESTION 1</span></span>
<span id="cb2-192"><a href="#cb2-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-193"><a href="#cb2-193" aria-hidden="true" tabindex="-1"></a>*Provide a visualization that shows our active awards from each sponsor.</span>
<span id="cb2-194"><a href="#cb2-194" aria-hidden="true" tabindex="-1"></a>I need to see their start date and end date, the amount of the award,</span>
<span id="cb2-195"><a href="#cb2-195" aria-hidden="true" tabindex="-1"></a>and the name of the Principal Investigator. I’m really interested in</span>
<span id="cb2-196"><a href="#cb2-196" aria-hidden="true" tabindex="-1"></a>seeing how far into the future our current portfolio will exist. Are</span>
<span id="cb2-197"><a href="#cb2-197" aria-hidden="true" tabindex="-1"></a>there a bunch of awards about to expire? Are there a bunch that just got</span>
<span id="cb2-198"><a href="#cb2-198" aria-hidden="true" tabindex="-1"></a>funded and will be active for a while? Does this vary across sponsors?*</span>
<span id="cb2-199"><a href="#cb2-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-200"><a href="#cb2-200" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Transforming DOE data}</span></span>
<span id="cb2-201"><a href="#cb2-201" aria-hidden="true" tabindex="-1"></a><span class="co"># Assuming your data is stored in a data frame called DOEawards</span></span>
<span id="cb2-202"><a href="#cb2-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-203"><a href="#cb2-203" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert 'Start Date' to date format</span></span>
<span id="cb2-204"><a href="#cb2-204" aria-hidden="true" tabindex="-1"></a>DOEawards<span class="sc">$</span><span class="st">"Start Date"</span> <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(DOEawards<span class="sc">$</span><span class="st">"Start Date"</span>, <span class="at">format =</span> <span class="st">"%m/%d/%Y"</span>)</span>
<span id="cb2-205"><a href="#cb2-205" aria-hidden="true" tabindex="-1"></a>DOEawards<span class="sc">$</span><span class="st">"End Date"</span> <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(DOEawards<span class="sc">$</span><span class="st">"End Date"</span>, <span class="at">format =</span> <span class="st">"%m/%d/%Y"</span>)</span>
<span id="cb2-206"><a href="#cb2-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-207"><a href="#cb2-207" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter data for grants awarded to "Regents of the University of Idaho"</span></span>
<span id="cb2-208"><a href="#cb2-208" aria-hidden="true" tabindex="-1"></a>DOEawards_df <span class="ot">&lt;-</span> DOEawards <span class="sc">%&gt;%</span></span>
<span id="cb2-209"><a href="#cb2-209" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Institution <span class="sc">==</span> <span class="st">"Regents of the University of Idaho"</span>)</span>
<span id="cb2-210"><a href="#cb2-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-211"><a href="#cb2-211" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter data for grants with an "Status" of "Active"</span></span>
<span id="cb2-212"><a href="#cb2-212" aria-hidden="true" tabindex="-1"></a>DOEawards_df_active_grants <span class="ot">&lt;-</span> DOEawards_df <span class="sc">%&gt;%</span></span>
<span id="cb2-213"><a href="#cb2-213" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="st">`</span><span class="at">Status</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Active"</span>)</span>
<span id="cb2-214"><a href="#cb2-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-215"><a href="#cb2-215" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove dollar signs and convert "Amount Awarded to Date" to numeric format</span></span>
<span id="cb2-216"><a href="#cb2-216" aria-hidden="true" tabindex="-1"></a>DOEawards_df_active_grants<span class="sc">$</span><span class="st">"Amount Awarded to Date"</span> <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">$"</span>, <span class="st">""</span>, DOEawards_df_active_grants<span class="sc">$</span><span class="st">"Amount Awarded to Date"</span>))</span>
<span id="cb2-217"><a href="#cb2-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-218"><a href="#cb2-218" aria-hidden="true" tabindex="-1"></a><span class="co"># Split PI column by comma and extract last name</span></span>
<span id="cb2-219"><a href="#cb2-219" aria-hidden="true" tabindex="-1"></a>PI_last_name <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="fu">strsplit</span>(<span class="fu">as.character</span>(DOEawards_df_active_grants<span class="sc">$</span>PI), <span class="st">", "</span>), <span class="cf">function</span>(x) x[<span class="dv">1</span>])</span>
<span id="cb2-220"><a href="#cb2-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-221"><a href="#cb2-221" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a new data frame with filtered and selected variables from DOEawards_df_active_grants</span></span>
<span id="cb2-222"><a href="#cb2-222" aria-hidden="true" tabindex="-1"></a>newDOEawards <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb2-223"><a href="#cb2-223" aria-hidden="true" tabindex="-1"></a>  <span class="at">Start_Date =</span> DOEawards_df_active_grants<span class="sc">$</span><span class="st">"Start Date"</span>,</span>
<span id="cb2-224"><a href="#cb2-224" aria-hidden="true" tabindex="-1"></a>  <span class="at">End_Date =</span> DOEawards_df_active_grants<span class="sc">$</span><span class="st">"End Date"</span>,</span>
<span id="cb2-225"><a href="#cb2-225" aria-hidden="true" tabindex="-1"></a>  <span class="at">PI =</span> DOEawards_df_active_grants<span class="sc">$</span>PI,</span>
<span id="cb2-226"><a href="#cb2-226" aria-hidden="true" tabindex="-1"></a>  <span class="at">PILastName =</span> PI_last_name,  <span class="co"># New column for last name</span></span>
<span id="cb2-227"><a href="#cb2-227" aria-hidden="true" tabindex="-1"></a>  <span class="at">PI_Grant =</span> <span class="fu">paste</span>(PI_last_name, DOEawards_df_active_grants<span class="sc">$</span><span class="st">"Register Number"</span>, <span class="at">sep =</span> <span class="st">" "</span>),  <span class="co"># New column combining last name and Register Number</span></span>
<span id="cb2-228"><a href="#cb2-228" aria-hidden="true" tabindex="-1"></a>  <span class="at">Amount_Awarded_to_Date =</span> DOEawards_df_active_grants<span class="sc">$</span><span class="st">"Amount Awarded to Date"</span></span>
<span id="cb2-229"><a href="#cb2-229" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-230"><a href="#cb2-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-231"><a href="#cb2-231" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a new column named "Sponsor" with the desired values</span></span>
<span id="cb2-232"><a href="#cb2-232" aria-hidden="true" tabindex="-1"></a>newDOEawards <span class="ot">&lt;-</span> <span class="fu">mutate</span>(newDOEawards, <span class="at">Sponsor =</span> <span class="st">"DOE"</span>)</span>
<span id="cb2-233"><a href="#cb2-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-234"><a href="#cb2-234" aria-hidden="true" tabindex="-1"></a><span class="co"># View the modified data set</span></span>
<span id="cb2-235"><a href="#cb2-235" aria-hidden="true" tabindex="-1"></a><span class="co"># head(newDOEawards)</span></span>
<span id="cb2-236"><a href="#cb2-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-237"><a href="#cb2-237" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb2-238"><a href="#cb2-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-239"><a href="#cb2-239" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Trial graphing newDOEawards, eval=FALSE}</span></span>
<span id="cb2-240"><a href="#cb2-240" aria-hidden="true" tabindex="-1"></a><span class="co"># Example visualization using both Start Date and End Date on the x-axis</span></span>
<span id="cb2-241"><a href="#cb2-241" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> newDOEawards, <span class="fu">aes</span>(<span class="at">x =</span> Start_Date, <span class="at">xend =</span> End_Date, <span class="at">y =</span> PI, <span class="at">yend =</span> PI, <span class="at">color =</span> Amount_Awarded_to_Date)) <span class="sc">+</span></span>
<span id="cb2-242"><a href="#cb2-242" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb2-243"><a href="#cb2-243" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"DOE U of I Active Awards Amount Over Time by PI"</span>,</span>
<span id="cb2-244"><a href="#cb2-244" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Time"</span>,</span>
<span id="cb2-245"><a href="#cb2-245" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Principal Investigator"</span>,</span>
<span id="cb2-246"><a href="#cb2-246" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Amount Awarded to Date"</span>) <span class="sc">+</span></span>
<span id="cb2-247"><a href="#cb2-247" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb2-248"><a href="#cb2-248" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(<span class="at">date_labels =</span> <span class="st">"%m-%Y"</span>, <span class="at">date_breaks =</span> <span class="st">"6 months"</span>)</span>
<span id="cb2-249"><a href="#cb2-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-250"><a href="#cb2-250" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb2-251"><a href="#cb2-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-252"><a href="#cb2-252" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Coloring by sponsors, eval = FALSE}</span></span>
<span id="cb2-253"><a href="#cb2-253" aria-hidden="true" tabindex="-1"></a><span class="co"># Example visualization using both Start Date and End Date on the x-axis</span></span>
<span id="cb2-254"><a href="#cb2-254" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> newDOEawards, <span class="fu">aes</span>(<span class="at">x =</span> Start_Date, <span class="at">xend =</span> End_Date, <span class="at">y =</span> PI, <span class="at">yend =</span> PI, <span class="at">color =</span> Sponsor)) <span class="sc">+</span></span>
<span id="cb2-255"><a href="#cb2-255" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb2-256"><a href="#cb2-256" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> End_Date, <span class="at">label =</span> scales<span class="sc">::</span><span class="fu">dollar</span>(Amount_Awarded_to_Date)), <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span>  <span class="co"># Add labels for award amounts</span></span>
<span id="cb2-257"><a href="#cb2-257" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"DOE U of I Active Awards Amount Over Time by PI"</span>,</span>
<span id="cb2-258"><a href="#cb2-258" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Time"</span>,</span>
<span id="cb2-259"><a href="#cb2-259" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Principal Investigator"</span>,</span>
<span id="cb2-260"><a href="#cb2-260" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Sponsor"</span>) <span class="sc">+</span></span>
<span id="cb2-261"><a href="#cb2-261" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb2-262"><a href="#cb2-262" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(<span class="at">date_labels =</span> <span class="st">"%m-%Y"</span>, <span class="at">date_breaks =</span> <span class="st">"6 months"</span>) <span class="sc">+</span></span>
<span id="cb2-263"><a href="#cb2-263" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(<span class="at">name =</span> <span class="st">"Sponsor"</span>)  <span class="co"># Customize legend title</span></span>
<span id="cb2-264"><a href="#cb2-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-265"><a href="#cb2-265" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb2-266"><a href="#cb2-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-267"><a href="#cb2-267" aria-hidden="true" tabindex="-1"></a>I am going to manipulate and make new data sets for all</span>
<span id="cb2-268"><a href="#cb2-268" aria-hidden="true" tabindex="-1"></a>sponsors. Then I will combine them all and plot a summary figure.</span>
<span id="cb2-269"><a href="#cb2-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-270"><a href="#cb2-270" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Transforming NSF}</span></span>
<span id="cb2-271"><a href="#cb2-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-272"><a href="#cb2-272" aria-hidden="true" tabindex="-1"></a><span class="co"># Assuming your data is stored in a data frame called NSFtoUI</span></span>
<span id="cb2-273"><a href="#cb2-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-274"><a href="#cb2-274" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to date format</span></span>
<span id="cb2-275"><a href="#cb2-275" aria-hidden="true" tabindex="-1"></a>NSFtoUI<span class="sc">$</span><span class="st">"startDate"</span> <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(NSFtoUI<span class="sc">$</span><span class="st">"startDate"</span>, <span class="at">format =</span> <span class="st">"%m/%d/%Y"</span>)</span>
<span id="cb2-276"><a href="#cb2-276" aria-hidden="true" tabindex="-1"></a>NSFtoUI<span class="sc">$</span><span class="st">"expDate"</span> <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(NSFtoUI<span class="sc">$</span><span class="st">"expDate"</span>, <span class="at">format =</span> <span class="st">"%m/%d/%Y"</span>)</span>
<span id="cb2-277"><a href="#cb2-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-278"><a href="#cb2-278" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter data for active grants </span></span>
<span id="cb2-279"><a href="#cb2-279" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter data for grants with a "expDate" on or after 03/20/2024</span></span>
<span id="cb2-280"><a href="#cb2-280" aria-hidden="true" tabindex="-1"></a>NSFtoUI_df_active_grants <span class="ot">&lt;-</span> NSFtoUI <span class="sc">%&gt;%</span></span>
<span id="cb2-281"><a href="#cb2-281" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="st">`</span><span class="at">expDate</span><span class="st">`</span> <span class="sc">&gt;=</span> <span class="fu">as.Date</span>(<span class="st">"2024-03-20"</span>)) </span>
<span id="cb2-282"><a href="#cb2-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-283"><a href="#cb2-283" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a new data frame with filtered and selected variables from NSFtoUI_df_active_grants</span></span>
<span id="cb2-284"><a href="#cb2-284" aria-hidden="true" tabindex="-1"></a>newNSFtoUI <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb2-285"><a href="#cb2-285" aria-hidden="true" tabindex="-1"></a>  <span class="at">Start_Date =</span> NSFtoUI_df_active_grants<span class="sc">$</span><span class="st">"startDate"</span>,</span>
<span id="cb2-286"><a href="#cb2-286" aria-hidden="true" tabindex="-1"></a>  <span class="at">End_Date =</span> NSFtoUI_df_active_grants<span class="sc">$</span><span class="st">"expDate"</span>,</span>
<span id="cb2-287"><a href="#cb2-287" aria-hidden="true" tabindex="-1"></a>  <span class="at">PI =</span> NSFtoUI_df_active_grants<span class="sc">$</span><span class="st">"piLastName"</span>,</span>
<span id="cb2-288"><a href="#cb2-288" aria-hidden="true" tabindex="-1"></a>  <span class="at">PI_Grant =</span> <span class="fu">paste</span>(NSFtoUI_df_active_grants<span class="sc">$</span><span class="st">"piLastName"</span>, NSFtoUI_df_active_grants<span class="sc">$</span>id, <span class="at">sep =</span> <span class="st">" "</span>),  <span class="co"># New column combining last name and id</span></span>
<span id="cb2-289"><a href="#cb2-289" aria-hidden="true" tabindex="-1"></a>  <span class="at">Amount_Awarded_to_Date =</span> NSFtoUI_df_active_grants<span class="sc">$</span><span class="st">"estimatedTotalAmt"</span></span>
<span id="cb2-290"><a href="#cb2-290" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-291"><a href="#cb2-291" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a new column named "Sponsor" with the desired values</span></span>
<span id="cb2-292"><a href="#cb2-292" aria-hidden="true" tabindex="-1"></a>newNSFtoUI <span class="ot">&lt;-</span> <span class="fu">mutate</span>(newNSFtoUI, <span class="at">Sponsor =</span> <span class="st">"NSF"</span>)</span>
<span id="cb2-293"><a href="#cb2-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-294"><a href="#cb2-294" aria-hidden="true" tabindex="-1"></a><span class="co"># View the modified data set</span></span>
<span id="cb2-295"><a href="#cb2-295" aria-hidden="true" tabindex="-1"></a><span class="co"># head(newNSFtoUI)</span></span>
<span id="cb2-296"><a href="#cb2-296" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb2-297"><a href="#cb2-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-298"><a href="#cb2-298" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Transforming NIH data}</span></span>
<span id="cb2-299"><a href="#cb2-299" aria-hidden="true" tabindex="-1"></a><span class="co"># Assuming your data is stored in a data frame called projects_df</span></span>
<span id="cb2-300"><a href="#cb2-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-301"><a href="#cb2-301" aria-hidden="true" tabindex="-1"></a><span class="co"># Assuming your data set is named projects_df</span></span>
<span id="cb2-302"><a href="#cb2-302" aria-hidden="true" tabindex="-1"></a>projects_df<span class="sc">$</span>project_start_date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(projects_df<span class="sc">$</span>project_start_date, <span class="at">format =</span> <span class="st">"%Y-%m-%dT%H:%M:%SZ"</span>)</span>
<span id="cb2-303"><a href="#cb2-303" aria-hidden="true" tabindex="-1"></a>projects_df<span class="sc">$</span>project_end_date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(projects_df<span class="sc">$</span>project_end_date, <span class="at">format =</span> <span class="st">"%Y-%m-%dT%H:%M:%SZ"</span>)</span>
<span id="cb2-304"><a href="#cb2-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-305"><a href="#cb2-305" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter data for grants awarded to "UNIVERSITY OF IDAHO"</span></span>
<span id="cb2-306"><a href="#cb2-306" aria-hidden="true" tabindex="-1"></a>projects_df_df <span class="ot">&lt;-</span> projects_df <span class="sc">%&gt;%</span></span>
<span id="cb2-307"><a href="#cb2-307" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="st">`</span><span class="at">organization.org_name</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"UNIVERSITY OF IDAHO"</span>)</span>
<span id="cb2-308"><a href="#cb2-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-309"><a href="#cb2-309" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter data for grants with an "is_active" of "TRUE"</span></span>
<span id="cb2-310"><a href="#cb2-310" aria-hidden="true" tabindex="-1"></a>projects_df_active_grants <span class="ot">&lt;-</span> projects_df_df <span class="sc">%&gt;%</span></span>
<span id="cb2-311"><a href="#cb2-311" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="st">`</span><span class="at">is_active</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"TRUE"</span>)</span>
<span id="cb2-312"><a href="#cb2-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-313"><a href="#cb2-313" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a new data frame with filtered and selected variables from projects_df_active_grants</span></span>
<span id="cb2-314"><a href="#cb2-314" aria-hidden="true" tabindex="-1"></a>newNIH <span class="ot">&lt;-</span> projects_df_active_grants <span class="sc">%&gt;%</span></span>
<span id="cb2-315"><a href="#cb2-315" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb2-316"><a href="#cb2-316" aria-hidden="true" tabindex="-1"></a>    <span class="at">PI =</span> <span class="fu">str_to_title</span>(contact_pi_name),  <span class="co"># Convert contact_pi_name to sentence case</span></span>
<span id="cb2-317"><a href="#cb2-317" aria-hidden="true" tabindex="-1"></a>    <span class="at">PILastName1 =</span> <span class="fu">sapply</span>(<span class="fu">strsplit</span>(<span class="fu">as.character</span>(PI), <span class="st">", "</span>), <span class="cf">function</span>(x) x[<span class="dv">1</span>]),  <span class="co"># Extract last name from PI column</span></span>
<span id="cb2-318"><a href="#cb2-318" aria-hidden="true" tabindex="-1"></a>    <span class="at">PI_Grant =</span> <span class="fu">paste</span>(PILastName1, project_serial_num, <span class="at">sep =</span> <span class="st">" "</span>)  <span class="co"># Combine PILastName1 and project_serial_num with a space</span></span>
<span id="cb2-319"><a href="#cb2-319" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb2-320"><a href="#cb2-320" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb2-321"><a href="#cb2-321" aria-hidden="true" tabindex="-1"></a>    <span class="at">Start_Date =</span> project_start_date,</span>
<span id="cb2-322"><a href="#cb2-322" aria-hidden="true" tabindex="-1"></a>    <span class="at">End_Date =</span> project_end_date,</span>
<span id="cb2-323"><a href="#cb2-323" aria-hidden="true" tabindex="-1"></a>    PI,</span>
<span id="cb2-324"><a href="#cb2-324" aria-hidden="true" tabindex="-1"></a>    PI_Grant,</span>
<span id="cb2-325"><a href="#cb2-325" aria-hidden="true" tabindex="-1"></a>    <span class="at">Amount_Awarded_to_Date =</span> direct_cost_amt</span>
<span id="cb2-326"><a href="#cb2-326" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb2-327"><a href="#cb2-327" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a new column named "Sponsor" with the desired values</span></span>
<span id="cb2-328"><a href="#cb2-328" aria-hidden="true" tabindex="-1"></a>newNIH <span class="ot">&lt;-</span> <span class="fu">mutate</span>(newNIH, <span class="at">Sponsor =</span> <span class="st">"NIH"</span>)</span>
<span id="cb2-329"><a href="#cb2-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-330"><a href="#cb2-330" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize the Amount_Awarded_to_Date for each unique PI_Grant while retaining other variables</span></span>
<span id="cb2-331"><a href="#cb2-331" aria-hidden="true" tabindex="-1"></a>newNIH <span class="ot">&lt;-</span> newNIH <span class="sc">%&gt;%</span></span>
<span id="cb2-332"><a href="#cb2-332" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(PI_Grant) <span class="sc">%&gt;%</span></span>
<span id="cb2-333"><a href="#cb2-333" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Amount_Awarded_to_Date =</span> <span class="fu">sum</span>(Amount_Awarded_to_Date, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb2-334"><a href="#cb2-334" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(PI_Grant, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-335"><a href="#cb2-335" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb2-336"><a href="#cb2-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-337"><a href="#cb2-337" aria-hidden="true" tabindex="-1"></a><span class="co"># View the modified data set</span></span>
<span id="cb2-338"><a href="#cb2-338" aria-hidden="true" tabindex="-1"></a><span class="co"># head(newNIH)</span></span>
<span id="cb2-339"><a href="#cb2-339" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb2-340"><a href="#cb2-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-341"><a href="#cb2-341" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Transforming USDA data}</span></span>
<span id="cb2-342"><a href="#cb2-342" aria-hidden="true" tabindex="-1"></a><span class="co"># Assuming your data is stored in a data frame called USDAtoUI</span></span>
<span id="cb2-343"><a href="#cb2-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-344"><a href="#cb2-344" aria-hidden="true" tabindex="-1"></a><span class="co"># Assuming your data set is named USDAtoUI</span></span>
<span id="cb2-345"><a href="#cb2-345" aria-hidden="true" tabindex="-1"></a>USDAtoUI<span class="sc">$</span><span class="st">"Award.Date"</span> <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="fu">as.character</span>(USDAtoUI<span class="sc">$</span><span class="st">"Award.Date"</span>), <span class="at">format =</span> <span class="st">"%m/%d/%Y"</span>)</span>
<span id="cb2-346"><a href="#cb2-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-347"><a href="#cb2-347" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter data for active grants </span></span>
<span id="cb2-348"><a href="#cb2-348" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter data for grants with a "Award.Date" on or after 01/01/2019</span></span>
<span id="cb2-349"><a href="#cb2-349" aria-hidden="true" tabindex="-1"></a>USDA_df_active_grants <span class="ot">&lt;-</span> USDAtoUI <span class="sc">%&gt;%</span></span>
<span id="cb2-350"><a href="#cb2-350" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="st">`</span><span class="at">Award.Date</span><span class="st">`</span> <span class="sc">&gt;=</span> <span class="fu">as.Date</span>(<span class="st">"2019-01-01"</span>)) </span>
<span id="cb2-351"><a href="#cb2-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-352"><a href="#cb2-352" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a new data frame with filtered and selected variables from USDA_df_active_grants</span></span>
<span id="cb2-353"><a href="#cb2-353" aria-hidden="true" tabindex="-1"></a>newUSDAtoUI <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb2-354"><a href="#cb2-354" aria-hidden="true" tabindex="-1"></a>  <span class="at">Start_Date =</span> USDA_df_active_grants<span class="sc">$</span><span class="st">"Award.Date"</span>,</span>
<span id="cb2-355"><a href="#cb2-355" aria-hidden="true" tabindex="-1"></a>  <span class="at">End_Date =</span> USDA_df_active_grants<span class="sc">$</span><span class="st">"Award.Date"</span>,</span>
<span id="cb2-356"><a href="#cb2-356" aria-hidden="true" tabindex="-1"></a>  <span class="at">Amount_Awarded_to_Date =</span> USDA_df_active_grants<span class="sc">$</span><span class="st">"Award.Dollars"</span></span>
<span id="cb2-357"><a href="#cb2-357" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-358"><a href="#cb2-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-359"><a href="#cb2-359" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a new column named "Sponsor" with the desired values</span></span>
<span id="cb2-360"><a href="#cb2-360" aria-hidden="true" tabindex="-1"></a>newUSDAtoUI <span class="ot">&lt;-</span> <span class="fu">mutate</span>(newUSDAtoUI, <span class="at">Sponsor =</span> <span class="st">"USDA"</span>)</span>
<span id="cb2-361"><a href="#cb2-361" aria-hidden="true" tabindex="-1"></a>newUSDAtoUI <span class="ot">&lt;-</span> <span class="fu">mutate</span>(newUSDAtoUI, <span class="at">PI =</span> <span class="st">"NA"</span>)</span>
<span id="cb2-362"><a href="#cb2-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-363"><a href="#cb2-363" aria-hidden="true" tabindex="-1"></a><span class="co"># View the modified data set</span></span>
<span id="cb2-364"><a href="#cb2-364" aria-hidden="true" tabindex="-1"></a><span class="co"># head(newUSDAtoUI)</span></span>
<span id="cb2-365"><a href="#cb2-365" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb2-366"><a href="#cb2-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-367"><a href="#cb2-367" aria-hidden="true" tabindex="-1"></a><span class="fu">## Putting all the active awards from various sponsors together</span></span>
<span id="cb2-368"><a href="#cb2-368" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Visualizing new data frames from all sponsors, eval = FALSE}</span></span>
<span id="cb2-369"><a href="#cb2-369" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb2-370"><a href="#cb2-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-371"><a href="#cb2-371" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert Amount_Awarded_to_Date to numeric for the data set where it's stored as character</span></span>
<span id="cb2-372"><a href="#cb2-372" aria-hidden="true" tabindex="-1"></a>newNSFtoUI <span class="ot">&lt;-</span> newNSFtoUI <span class="sc">%&gt;%</span></span>
<span id="cb2-373"><a href="#cb2-373" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Amount_Awarded_to_Date =</span> <span class="fu">as.numeric</span>(Amount_Awarded_to_Date))</span>
<span id="cb2-374"><a href="#cb2-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-375"><a href="#cb2-375" aria-hidden="true" tabindex="-1"></a><span class="co"># Bind the rows of the datasets</span></span>
<span id="cb2-376"><a href="#cb2-376" aria-hidden="true" tabindex="-1"></a>combined_active_grants_df <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb2-377"><a href="#cb2-377" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(newDOEawards, <span class="at">dataset =</span> <span class="st">"DOE"</span>),</span>
<span id="cb2-378"><a href="#cb2-378" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(newNSFtoUI, <span class="at">dataset =</span> <span class="st">"NSF"</span>),</span>
<span id="cb2-379"><a href="#cb2-379" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(newNIH, <span class="at">dataset =</span> <span class="st">"NIH"</span>)</span>
<span id="cb2-380"><a href="#cb2-380" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-381"><a href="#cb2-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-382"><a href="#cb2-382" aria-hidden="true" tabindex="-1"></a><span class="co"># Sort PI_Grant by Start_Date</span></span>
<span id="cb2-383"><a href="#cb2-383" aria-hidden="true" tabindex="-1"></a>combined_active_grants_df <span class="ot">&lt;-</span> combined_active_grants_df <span class="sc">%&gt;%</span></span>
<span id="cb2-384"><a href="#cb2-384" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Start_Date) <span class="sc">%&gt;%</span></span>
<span id="cb2-385"><a href="#cb2-385" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb2-386"><a href="#cb2-386" aria-hidden="true" tabindex="-1"></a>    <span class="at">PI_Grant =</span> <span class="fu">factor</span>(PI_Grant, <span class="at">levels =</span> <span class="fu">unique</span>(PI_Grant))</span>
<span id="cb2-387"><a href="#cb2-387" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb2-388"><a href="#cb2-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-389"><a href="#cb2-389" aria-hidden="true" tabindex="-1"></a><span class="co"># Define custom colors for each sponsor</span></span>
<span id="cb2-390"><a href="#cb2-390" aria-hidden="true" tabindex="-1"></a>sponsor_colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"DOE"</span> <span class="ot">=</span> <span class="st">"blue"</span>, <span class="st">"NIH"</span> <span class="ot">=</span> <span class="st">"green"</span>, <span class="st">"NSF"</span> <span class="ot">=</span> <span class="st">"red"</span>)</span>
<span id="cb2-391"><a href="#cb2-391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-392"><a href="#cb2-392" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter the data to include only those with a start date from 2017 onwards</span></span>
<span id="cb2-393"><a href="#cb2-393" aria-hidden="true" tabindex="-1"></a>combined_active_grants_df_filtered <span class="ot">&lt;-</span> combined_active_grants_df <span class="sc">%&gt;%</span></span>
<span id="cb2-394"><a href="#cb2-394" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Start_Date <span class="sc">&gt;=</span> <span class="fu">as.Date</span>(<span class="st">"2017-01-01"</span>))</span>
<span id="cb2-395"><a href="#cb2-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-396"><a href="#cb2-396" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder PI_Grant by last name and start date</span></span>
<span id="cb2-397"><a href="#cb2-397" aria-hidden="true" tabindex="-1"></a>combined_active_grants_df_filtered <span class="ot">&lt;-</span> combined_active_grants_df_filtered <span class="sc">%&gt;%</span></span>
<span id="cb2-398"><a href="#cb2-398" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Last_Name =</span> <span class="fu">sub</span>(<span class="st">"^(</span><span class="sc">\\</span><span class="st">S+)</span><span class="sc">\\</span><span class="st">s.*"</span>, <span class="st">"</span><span class="sc">\\</span><span class="st">1"</span>, PI_Grant)) <span class="sc">%&gt;%</span></span>
<span id="cb2-399"><a href="#cb2-399" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Last_Name, <span class="fu">desc</span>(Start_Date)) <span class="sc">%&gt;%</span></span>
<span id="cb2-400"><a href="#cb2-400" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PI_Grant =</span> <span class="fu">factor</span>(PI_Grant, <span class="at">levels =</span> <span class="fu">unique</span>(PI_Grant)))</span>
<span id="cb2-401"><a href="#cb2-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-402"><a href="#cb2-402" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the filtered data</span></span>
<span id="cb2-403"><a href="#cb2-403" aria-hidden="true" tabindex="-1"></a>question1plot_filtered <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> combined_active_grants_df_filtered, <span class="fu">aes</span>(<span class="at">x =</span> Start_Date, <span class="at">xend =</span> End_Date, <span class="at">y =</span> PI_Grant)) <span class="sc">+</span></span>
<span id="cb2-404"><a href="#cb2-404" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">yend =</span> PI_Grant, <span class="at">color =</span> Sponsor), <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb2-405"><a href="#cb2-405" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> Amount_Awarded_to_Date, <span class="at">x =</span> End_Date, <span class="at">y =</span> PI_Grant), <span class="at">size =</span> <span class="fl">2.5</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.1</span>) <span class="sc">+</span>  <span class="co"># Changed hjust to position outside the bars</span></span>
<span id="cb2-406"><a href="#cb2-406" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"U of I Active Awards Amount Over Time by PI (Since 2017)"</span>,</span>
<span id="cb2-407"><a href="#cb2-407" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Time"</span>,</span>
<span id="cb2-408"><a href="#cb2-408" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"PI Grant"</span>,</span>
<span id="cb2-409"><a href="#cb2-409" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Sponsor"</span>) <span class="sc">+</span></span>
<span id="cb2-410"><a href="#cb2-410" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">6</span>),</span>
<span id="cb2-411"><a href="#cb2-411" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">6</span>),</span>
<span id="cb2-412"><a href="#cb2-412" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb2-413"><a href="#cb2-413" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb2-414"><a href="#cb2-414" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb2-415"><a href="#cb2-415" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="st">"cm"</span>)) <span class="sc">+</span></span>
<span id="cb2-416"><a href="#cb2-416" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(<span class="at">date_labels =</span> <span class="st">"%m-%Y"</span>, <span class="at">date_breaks =</span> <span class="st">"12 months"</span>) <span class="sc">+</span></span>
<span id="cb2-417"><a href="#cb2-417" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">"Sponsor"</span>, <span class="at">values =</span> sponsor_colors)</span>
<span id="cb2-418"><a href="#cb2-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-419"><a href="#cb2-419" aria-hidden="true" tabindex="-1"></a>question1plot_filtered</span>
<span id="cb2-420"><a href="#cb2-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-421"><a href="#cb2-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-422"><a href="#cb2-422" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb2-423"><a href="#cb2-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-424"><a href="#cb2-424" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Save}</span></span>
<span id="cb2-425"><a href="#cb2-425" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert Amount_Awarded_to_Date to numeric for the data set where it's stored as character</span></span>
<span id="cb2-426"><a href="#cb2-426" aria-hidden="true" tabindex="-1"></a>newNSFtoUI <span class="ot">&lt;-</span> newNSFtoUI <span class="sc">%&gt;%</span></span>
<span id="cb2-427"><a href="#cb2-427" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Amount_Awarded_to_Date =</span> <span class="fu">as.numeric</span>(Amount_Awarded_to_Date))</span>
<span id="cb2-428"><a href="#cb2-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-429"><a href="#cb2-429" aria-hidden="true" tabindex="-1"></a><span class="co"># Bind the rows of the datasets</span></span>
<span id="cb2-430"><a href="#cb2-430" aria-hidden="true" tabindex="-1"></a>combined_active_grants_df <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb2-431"><a href="#cb2-431" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(newDOEawards, <span class="at">dataset =</span> <span class="st">"DOE"</span>),</span>
<span id="cb2-432"><a href="#cb2-432" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(newNSFtoUI, <span class="at">dataset =</span> <span class="st">"NSF"</span>),</span>
<span id="cb2-433"><a href="#cb2-433" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(newNIH, <span class="at">dataset =</span> <span class="st">"NIH"</span>)</span>
<span id="cb2-434"><a href="#cb2-434" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-435"><a href="#cb2-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-436"><a href="#cb2-436" aria-hidden="true" tabindex="-1"></a><span class="co"># Sort PI_Grant by Start_Date</span></span>
<span id="cb2-437"><a href="#cb2-437" aria-hidden="true" tabindex="-1"></a>combined_active_grants_df <span class="ot">&lt;-</span> combined_active_grants_df <span class="sc">%&gt;%</span></span>
<span id="cb2-438"><a href="#cb2-438" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Start_Date) <span class="sc">%&gt;%</span></span>
<span id="cb2-439"><a href="#cb2-439" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb2-440"><a href="#cb2-440" aria-hidden="true" tabindex="-1"></a>    <span class="at">PI_Grant =</span> <span class="fu">factor</span>(PI_Grant, <span class="at">levels =</span> <span class="fu">unique</span>(PI_Grant))</span>
<span id="cb2-441"><a href="#cb2-441" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb2-442"><a href="#cb2-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-443"><a href="#cb2-443" aria-hidden="true" tabindex="-1"></a><span class="co"># Define custom colors for each sponsor</span></span>
<span id="cb2-444"><a href="#cb2-444" aria-hidden="true" tabindex="-1"></a>sponsor_colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"DOE"</span> <span class="ot">=</span> <span class="st">"blue"</span>, <span class="st">"NIH"</span> <span class="ot">=</span> <span class="st">"green"</span>, <span class="st">"NSF"</span> <span class="ot">=</span> <span class="st">"red"</span>)</span>
<span id="cb2-445"><a href="#cb2-445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-446"><a href="#cb2-446" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter the data to include only those with a start date from 2017 onwards</span></span>
<span id="cb2-447"><a href="#cb2-447" aria-hidden="true" tabindex="-1"></a>combined_active_grants_df_filtered <span class="ot">&lt;-</span> combined_active_grants_df <span class="sc">%&gt;%</span></span>
<span id="cb2-448"><a href="#cb2-448" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Start_Date <span class="sc">&gt;=</span> <span class="fu">as.Date</span>(<span class="st">"2017-01-01"</span>))</span>
<span id="cb2-449"><a href="#cb2-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-450"><a href="#cb2-450" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder PI_Grant by last name and start date</span></span>
<span id="cb2-451"><a href="#cb2-451" aria-hidden="true" tabindex="-1"></a>combined_active_grants_df_filtered <span class="ot">&lt;-</span> combined_active_grants_df_filtered <span class="sc">%&gt;%</span></span>
<span id="cb2-452"><a href="#cb2-452" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Last_Name =</span> <span class="fu">sub</span>(<span class="st">"^(</span><span class="sc">\\</span><span class="st">S+)</span><span class="sc">\\</span><span class="st">s.*"</span>, <span class="st">"</span><span class="sc">\\</span><span class="st">1"</span>, PI_Grant)) <span class="sc">%&gt;%</span></span>
<span id="cb2-453"><a href="#cb2-453" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Last_Name, <span class="fu">desc</span>(Start_Date)) <span class="sc">%&gt;%</span></span>
<span id="cb2-454"><a href="#cb2-454" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PI_Grant =</span> <span class="fu">factor</span>(PI_Grant, <span class="at">levels =</span> <span class="fu">unique</span>(PI_Grant)))</span>
<span id="cb2-455"><a href="#cb2-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-456"><a href="#cb2-456" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the filtered data</span></span>
<span id="cb2-457"><a href="#cb2-457" aria-hidden="true" tabindex="-1"></a>question1plot_filtered <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> combined_active_grants_df_filtered, <span class="fu">aes</span>(<span class="at">x =</span> Start_Date, <span class="at">xend =</span> End_Date, <span class="at">y =</span> PI_Grant)) <span class="sc">+</span></span>
<span id="cb2-458"><a href="#cb2-458" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">yend =</span> PI_Grant, <span class="at">color =</span> Sponsor), <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb2-459"><a href="#cb2-459" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> Amount_Awarded_to_Date, <span class="at">x =</span> End_Date, <span class="at">y =</span> PI_Grant), <span class="at">size =</span> <span class="fl">2.5</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.1</span>) <span class="sc">+</span>  <span class="co"># Changed hjust to position outside the bars</span></span>
<span id="cb2-460"><a href="#cb2-460" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"U of I Active Awards Amount Over Time by PI (Since 2017)"</span>,</span>
<span id="cb2-461"><a href="#cb2-461" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Time"</span>,</span>
<span id="cb2-462"><a href="#cb2-462" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"PI Grant"</span>,</span>
<span id="cb2-463"><a href="#cb2-463" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Sponsor"</span>) <span class="sc">+</span></span>
<span id="cb2-464"><a href="#cb2-464" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">6</span>),</span>
<span id="cb2-465"><a href="#cb2-465" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">6</span>),</span>
<span id="cb2-466"><a href="#cb2-466" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb2-467"><a href="#cb2-467" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb2-468"><a href="#cb2-468" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb2-469"><a href="#cb2-469" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="st">"cm"</span>)) <span class="sc">+</span></span>
<span id="cb2-470"><a href="#cb2-470" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(<span class="at">date_labels =</span> <span class="st">"%m-%Y"</span>, <span class="at">date_breaks =</span> <span class="st">"12 months"</span>) <span class="sc">+</span></span>
<span id="cb2-471"><a href="#cb2-471" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">"Sponsor"</span>, <span class="at">values =</span> sponsor_colors)</span>
<span id="cb2-472"><a href="#cb2-472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-473"><a href="#cb2-473" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"question1plot.png"</span>, <span class="at">plot =</span> question1plot_filtered, <span class="at">width =</span> <span class="dv">15</span>, <span class="at">height =</span> <span class="dv">10</span>)</span>
<span id="cb2-474"><a href="#cb2-474" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb2-475"><a href="#cb2-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-476"><a href="#cb2-476" aria-hidden="true" tabindex="-1"></a><span class="al">![Question1Visualization](question1plot.png)</span></span>
<span id="cb2-477"><a href="#cb2-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-478"><a href="#cb2-478" aria-hidden="true" tabindex="-1"></a>**Figure 3.** This figure shows U of I PI last names and their active grants they have received as of 2017. The bars are colored by sponsor and the text amount signifies the amount they have received for said award. The USDA data is not included due to a lack of necessary variables. The strengths of this figure is that it displays, rather than over plots, PIs who have multiple awards. Limitations are that this figure only includes grants that have started in 2017 and on. </span>
<span id="cb2-479"><a href="#cb2-479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-480"><a href="#cb2-480" aria-hidden="true" tabindex="-1"></a><span class="fu"># QUESTION 2</span></span>
<span id="cb2-481"><a href="#cb2-481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-482"><a href="#cb2-482" aria-hidden="true" tabindex="-1"></a>*What is the proportional representation of new awards to the UI from</span>
<span id="cb2-483"><a href="#cb2-483" aria-hidden="true" tabindex="-1"></a>these various sources over the past 5 to 10 years? Are there any trends</span>
<span id="cb2-484"><a href="#cb2-484" aria-hidden="true" tabindex="-1"></a>that are encouraging or discouraging?*</span>
<span id="cb2-485"><a href="#cb2-485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-486"><a href="#cb2-486" aria-hidden="true" tabindex="-1"></a><span class="in">```{r DOE New Grant Counts}</span></span>
<span id="cb2-487"><a href="#cb2-487" aria-hidden="true" tabindex="-1"></a><span class="co"># Assuming your data is stored in a data frame called DOEawards</span></span>
<span id="cb2-488"><a href="#cb2-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-489"><a href="#cb2-489" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert 'Start Date' to date format</span></span>
<span id="cb2-490"><a href="#cb2-490" aria-hidden="true" tabindex="-1"></a>DOEawards<span class="sc">$</span><span class="st">"Start Date"</span> <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(DOEawards<span class="sc">$</span><span class="st">"Start Date"</span>, <span class="at">format =</span> <span class="st">"%m/%d/%Y"</span>)</span>
<span id="cb2-491"><a href="#cb2-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-492"><a href="#cb2-492" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter data for grants awarded to "Regents of the University of Idaho"</span></span>
<span id="cb2-493"><a href="#cb2-493" aria-hidden="true" tabindex="-1"></a>DOEawards_df <span class="ot">&lt;-</span> DOEawards <span class="sc">%&gt;%</span></span>
<span id="cb2-494"><a href="#cb2-494" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Institution <span class="sc">==</span> <span class="st">"Regents of the University of Idaho"</span>)</span>
<span id="cb2-495"><a href="#cb2-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-496"><a href="#cb2-496" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter data for grants with an "Action Type" of "New"</span></span>
<span id="cb2-497"><a href="#cb2-497" aria-hidden="true" tabindex="-1"></a>DOEawards_df_new_grants <span class="ot">&lt;-</span> DOEawards_df <span class="sc">%&gt;%</span></span>
<span id="cb2-498"><a href="#cb2-498" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="st">`</span><span class="at">Action Type</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"New"</span>)</span>
<span id="cb2-499"><a href="#cb2-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-500"><a href="#cb2-500" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter data for grants with a "Start Date" on or after 01/01/2014</span></span>
<span id="cb2-501"><a href="#cb2-501" aria-hidden="true" tabindex="-1"></a>DOEawards_df_new_grants <span class="ot">&lt;-</span> DOEawards_df_new_grants <span class="sc">%&gt;%</span></span>
<span id="cb2-502"><a href="#cb2-502" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="st">`</span><span class="at">Start Date</span><span class="st">`</span> <span class="sc">&gt;=</span> <span class="fu">as.Date</span>(<span class="st">"2014-01-01"</span>)) </span>
<span id="cb2-503"><a href="#cb2-503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-504"><a href="#cb2-504" aria-hidden="true" tabindex="-1"></a><span class="co"># Count the number of new grants for each year</span></span>
<span id="cb2-505"><a href="#cb2-505" aria-hidden="true" tabindex="-1"></a>new_grants_count <span class="ot">&lt;-</span> DOEawards_df_new_grants <span class="sc">%&gt;%</span></span>
<span id="cb2-506"><a href="#cb2-506" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="at">Year =</span> lubridate<span class="sc">::</span><span class="fu">year</span>(<span class="st">`</span><span class="at">Start Date</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb2-507"><a href="#cb2-507" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Count =</span> <span class="fu">n</span>())</span>
<span id="cb2-508"><a href="#cb2-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-509"><a href="#cb2-509" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb2-510"><a href="#cb2-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-511"><a href="#cb2-511" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Plot practice, eval = FALSE}</span></span>
<span id="cb2-512"><a href="#cb2-512" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting</span></span>
<span id="cb2-513"><a href="#cb2-513" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(new_grants_count, <span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> Count)) <span class="sc">+</span></span>
<span id="cb2-514"><a href="#cb2-514" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"skyblue"</span>) <span class="sc">+</span></span>
<span id="cb2-515"><a href="#cb2-515" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Number of New DOE Grants to the University of Idaho (2014-Now)"</span>,</span>
<span id="cb2-516"><a href="#cb2-516" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Year"</span>,</span>
<span id="cb2-517"><a href="#cb2-517" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Number of New Grants"</span>) <span class="sc">+</span></span>
<span id="cb2-518"><a href="#cb2-518" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb2-519"><a href="#cb2-519" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb2-520"><a href="#cb2-520" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="fu">min</span>(new_grants_count<span class="sc">$</span>Year, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="fu">max</span>(new_grants_count<span class="sc">$</span>Year, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">by =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb2-521"><a href="#cb2-521" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> Count), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb2-522"><a href="#cb2-522" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb2-523"><a href="#cb2-523" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb2-524"><a href="#cb2-524" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb2-525"><a href="#cb2-525" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb2-526"><a href="#cb2-526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-527"><a href="#cb2-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-528"><a href="#cb2-528" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Finishing DOE new grants count}</span></span>
<span id="cb2-529"><a href="#cb2-529" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a new column named "Sponsor" with the desired values</span></span>
<span id="cb2-530"><a href="#cb2-530" aria-hidden="true" tabindex="-1"></a>DOE_new_grants_count <span class="ot">&lt;-</span> <span class="fu">mutate</span>(new_grants_count, <span class="at">Sponsor =</span> <span class="st">"DOE"</span>)</span>
<span id="cb2-531"><a href="#cb2-531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-532"><a href="#cb2-532" aria-hidden="true" tabindex="-1"></a><span class="co"># View the modified data set</span></span>
<span id="cb2-533"><a href="#cb2-533" aria-hidden="true" tabindex="-1"></a><span class="co"># head(DOE_new_grants_count)</span></span>
<span id="cb2-534"><a href="#cb2-534" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb2-535"><a href="#cb2-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-536"><a href="#cb2-536" aria-hidden="true" tabindex="-1"></a><span class="in">```{r NSF New Grant Counts}</span></span>
<span id="cb2-537"><a href="#cb2-537" aria-hidden="true" tabindex="-1"></a><span class="co"># Assuming your data is stored in a data frame called NSFtoUI</span></span>
<span id="cb2-538"><a href="#cb2-538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-539"><a href="#cb2-539" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert 'Date' to date format</span></span>
<span id="cb2-540"><a href="#cb2-540" aria-hidden="true" tabindex="-1"></a>NSFtoUI<span class="sc">$</span><span class="st">"startDate"</span> <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(NSFtoUI<span class="sc">$</span><span class="st">"startDate"</span>, <span class="at">format =</span> <span class="st">"%m/%d/%Y"</span>)</span>
<span id="cb2-541"><a href="#cb2-541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-542"><a href="#cb2-542" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter data for grants awarded to "Regents of the University of Idaho"</span></span>
<span id="cb2-543"><a href="#cb2-543" aria-hidden="true" tabindex="-1"></a><span class="co"># Already are!</span></span>
<span id="cb2-544"><a href="#cb2-544" aria-hidden="true" tabindex="-1"></a><span class="co"># NSFtoUI_df &lt;- NSFtoUI %&gt;%</span></span>
<span id="cb2-545"><a href="#cb2-545" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(Institution == "Regents of the University of Idaho")</span></span>
<span id="cb2-546"><a href="#cb2-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-547"><a href="#cb2-547" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter data for grants with an "transType" of "Standard Grant"</span></span>
<span id="cb2-548"><a href="#cb2-548" aria-hidden="true" tabindex="-1"></a>NSFtoUI_df_new_grants <span class="ot">&lt;-</span> NSFtoUI <span class="sc">%&gt;%</span></span>
<span id="cb2-549"><a href="#cb2-549" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="st">`</span><span class="at">transType</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Standard Grant"</span>)</span>
<span id="cb2-550"><a href="#cb2-550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-551"><a href="#cb2-551" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter data for grants with a "date" on or after 01/01/2014</span></span>
<span id="cb2-552"><a href="#cb2-552" aria-hidden="true" tabindex="-1"></a>NSFtoUI_df_new_grants <span class="ot">&lt;-</span> NSFtoUI_df_new_grants <span class="sc">%&gt;%</span></span>
<span id="cb2-553"><a href="#cb2-553" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="st">`</span><span class="at">startDate</span><span class="st">`</span> <span class="sc">&gt;=</span> <span class="fu">as.Date</span>(<span class="st">"2014-01-01"</span>)) </span>
<span id="cb2-554"><a href="#cb2-554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-555"><a href="#cb2-555" aria-hidden="true" tabindex="-1"></a><span class="co"># Count the number of new grants for each year</span></span>
<span id="cb2-556"><a href="#cb2-556" aria-hidden="true" tabindex="-1"></a>NSF_new_grants_count <span class="ot">&lt;-</span> NSFtoUI_df_new_grants <span class="sc">%&gt;%</span></span>
<span id="cb2-557"><a href="#cb2-557" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="at">Year =</span> lubridate<span class="sc">::</span><span class="fu">year</span>(<span class="st">`</span><span class="at">startDate</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb2-558"><a href="#cb2-558" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Count =</span> <span class="fu">n</span>())</span>
<span id="cb2-559"><a href="#cb2-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-560"><a href="#cb2-560" aria-hidden="true" tabindex="-1"></a><span class="co"># Finishing NSF new grants count with NSF column</span></span>
<span id="cb2-561"><a href="#cb2-561" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a new column named "Sponsor" with the desired values</span></span>
<span id="cb2-562"><a href="#cb2-562" aria-hidden="true" tabindex="-1"></a>NSF_new_grants_count <span class="ot">&lt;-</span> <span class="fu">mutate</span>(NSF_new_grants_count, <span class="at">Sponsor =</span> <span class="st">"NSF"</span>)</span>
<span id="cb2-563"><a href="#cb2-563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-564"><a href="#cb2-564" aria-hidden="true" tabindex="-1"></a><span class="co"># View the modified data set</span></span>
<span id="cb2-565"><a href="#cb2-565" aria-hidden="true" tabindex="-1"></a><span class="co"># head(NSF_new_grants_count)</span></span>
<span id="cb2-566"><a href="#cb2-566" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb2-567"><a href="#cb2-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-568"><a href="#cb2-568" aria-hidden="true" tabindex="-1"></a><span class="in">```{r NIH New Grant Counts}</span></span>
<span id="cb2-569"><a href="#cb2-569" aria-hidden="true" tabindex="-1"></a><span class="co"># Assuming your data is stored in a data frame called projects_df</span></span>
<span id="cb2-570"><a href="#cb2-570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-571"><a href="#cb2-571" aria-hidden="true" tabindex="-1"></a><span class="co"># Assuming your data set is named projects_df</span></span>
<span id="cb2-572"><a href="#cb2-572" aria-hidden="true" tabindex="-1"></a>projects_df<span class="sc">$</span>project_start_date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(projects_df<span class="sc">$</span>project_start_date, <span class="at">format =</span> <span class="st">"%Y-%m-%dT%H:%M:%SZ"</span>)</span>
<span id="cb2-573"><a href="#cb2-573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-574"><a href="#cb2-574" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter data for grants awarded to "UNIVERSITY OF IDAHO"</span></span>
<span id="cb2-575"><a href="#cb2-575" aria-hidden="true" tabindex="-1"></a>projects_df_df <span class="ot">&lt;-</span> projects_df <span class="sc">%&gt;%</span></span>
<span id="cb2-576"><a href="#cb2-576" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="st">`</span><span class="at">organization.org_name</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"UNIVERSITY OF IDAHO"</span>)</span>
<span id="cb2-577"><a href="#cb2-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-578"><a href="#cb2-578" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter data for grants with an new grants</span></span>
<span id="cb2-579"><a href="#cb2-579" aria-hidden="true" tabindex="-1"></a><span class="co"># projects_df_new_grants &lt;- projects_df_df %&gt;%</span></span>
<span id="cb2-580"><a href="#cb2-580" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(`is_new` == "TRUE")</span></span>
<span id="cb2-581"><a href="#cb2-581" aria-hidden="true" tabindex="-1"></a><span class="co"># I took this out becuase upon updating, the grants from 2024 considered "new" before were no longer considered "new".</span></span>
<span id="cb2-582"><a href="#cb2-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-583"><a href="#cb2-583" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter data for grants with a "project_start_date" on or after 01/01/2014</span></span>
<span id="cb2-584"><a href="#cb2-584" aria-hidden="true" tabindex="-1"></a>projects_df_new_grants <span class="ot">&lt;-</span> projects_df_df <span class="sc">%&gt;%</span></span>
<span id="cb2-585"><a href="#cb2-585" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="st">`</span><span class="at">project_start_date</span><span class="st">`</span> <span class="sc">&gt;=</span> <span class="fu">as.Date</span>(<span class="st">"2014-01-01"</span>)) </span>
<span id="cb2-586"><a href="#cb2-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-587"><a href="#cb2-587" aria-hidden="true" tabindex="-1"></a><span class="co"># Count the number of new grants for each year</span></span>
<span id="cb2-588"><a href="#cb2-588" aria-hidden="true" tabindex="-1"></a>projects_df_new_grants_count <span class="ot">&lt;-</span> projects_df_new_grants <span class="sc">%&gt;%</span></span>
<span id="cb2-589"><a href="#cb2-589" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="at">Year =</span> lubridate<span class="sc">::</span><span class="fu">year</span>(<span class="st">`</span><span class="at">project_start_date</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb2-590"><a href="#cb2-590" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Count =</span> <span class="fu">n</span>())</span>
<span id="cb2-591"><a href="#cb2-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-592"><a href="#cb2-592" aria-hidden="true" tabindex="-1"></a><span class="co"># Finishing NSF new grants count with NSF column</span></span>
<span id="cb2-593"><a href="#cb2-593" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a new column named "Sponsor" with the desired values</span></span>
<span id="cb2-594"><a href="#cb2-594" aria-hidden="true" tabindex="-1"></a>NIH_new_grants_count <span class="ot">&lt;-</span> <span class="fu">mutate</span>(projects_df_new_grants_count, <span class="at">Sponsor =</span> <span class="st">"NIH"</span>)</span>
<span id="cb2-595"><a href="#cb2-595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-596"><a href="#cb2-596" aria-hidden="true" tabindex="-1"></a><span class="co"># View the modified data set</span></span>
<span id="cb2-597"><a href="#cb2-597" aria-hidden="true" tabindex="-1"></a><span class="co"># head(NIH_new_grants_count)</span></span>
<span id="cb2-598"><a href="#cb2-598" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb2-599"><a href="#cb2-599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-600"><a href="#cb2-600" aria-hidden="true" tabindex="-1"></a><span class="in">```{r USDA New Grant Counts}</span></span>
<span id="cb2-601"><a href="#cb2-601" aria-hidden="true" tabindex="-1"></a><span class="co"># Assuming your data is stored in a data frame called USDAtoUI</span></span>
<span id="cb2-602"><a href="#cb2-602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-603"><a href="#cb2-603" aria-hidden="true" tabindex="-1"></a>USDAtoUI2<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">"USDAtoUI.csv"</span>)</span>
<span id="cb2-604"><a href="#cb2-604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-605"><a href="#cb2-605" aria-hidden="true" tabindex="-1"></a><span class="co"># Assuming your data set is named USDAtoUI</span></span>
<span id="cb2-606"><a href="#cb2-606" aria-hidden="true" tabindex="-1"></a>USDAtoUI2<span class="sc">$</span><span class="st">"Award.Date"</span> <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="fu">as.character</span>(USDAtoUI2<span class="sc">$</span><span class="st">"Award.Date"</span>), <span class="at">format =</span> <span class="st">"%m/%d/%Y"</span>)</span>
<span id="cb2-607"><a href="#cb2-607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-608"><a href="#cb2-608" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter data for grants with a "Award.Date" on or after 01/01/2014</span></span>
<span id="cb2-609"><a href="#cb2-609" aria-hidden="true" tabindex="-1"></a>USDA2_df_new_grants <span class="ot">&lt;-</span> USDAtoUI2 <span class="sc">%&gt;%</span></span>
<span id="cb2-610"><a href="#cb2-610" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="st">`</span><span class="at">Award.Date</span><span class="st">`</span> <span class="sc">&gt;=</span> <span class="fu">as.Date</span>(<span class="st">"2014-01-01"</span>)) </span>
<span id="cb2-611"><a href="#cb2-611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-612"><a href="#cb2-612" aria-hidden="true" tabindex="-1"></a><span class="co"># Count the number of new grants for each year</span></span>
<span id="cb2-613"><a href="#cb2-613" aria-hidden="true" tabindex="-1"></a>USDA2_df_new_grants_count <span class="ot">&lt;-</span> USDA2_df_new_grants <span class="sc">%&gt;%</span></span>
<span id="cb2-614"><a href="#cb2-614" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="at">Year =</span> lubridate<span class="sc">::</span><span class="fu">year</span>(<span class="st">`</span><span class="at">Award.Date</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb2-615"><a href="#cb2-615" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Count =</span> <span class="fu">n</span>())</span>
<span id="cb2-616"><a href="#cb2-616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-617"><a href="#cb2-617" aria-hidden="true" tabindex="-1"></a><span class="co"># Finishing NSF new grants count with NSF column</span></span>
<span id="cb2-618"><a href="#cb2-618" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a new column named "Sponsor" with the desired values</span></span>
<span id="cb2-619"><a href="#cb2-619" aria-hidden="true" tabindex="-1"></a>USDA2_new_grants_count <span class="ot">&lt;-</span> <span class="fu">mutate</span>(USDA2_df_new_grants_count, <span class="at">Sponsor =</span> <span class="st">"USDA"</span>)</span>
<span id="cb2-620"><a href="#cb2-620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-621"><a href="#cb2-621" aria-hidden="true" tabindex="-1"></a><span class="co"># View the modified dataset</span></span>
<span id="cb2-622"><a href="#cb2-622" aria-hidden="true" tabindex="-1"></a><span class="co"># head(USDA2_new_grants_count)</span></span>
<span id="cb2-623"><a href="#cb2-623" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb2-624"><a href="#cb2-624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-625"><a href="#cb2-625" aria-hidden="true" tabindex="-1"></a><span class="fu">## Putting all the sponsors together</span></span>
<span id="cb2-626"><a href="#cb2-626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-627"><a href="#cb2-627" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Visualizing all sponsors}</span></span>
<span id="cb2-628"><a href="#cb2-628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-629"><a href="#cb2-629" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine data sets (assuming DOE_new_grants_count, NSF_new_grants_count, NIH_new_grants_count, and USDA_new_grants_count are your datasets)</span></span>
<span id="cb2-630"><a href="#cb2-630" aria-hidden="true" tabindex="-1"></a>combined_grant_counts_df <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb2-631"><a href="#cb2-631" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(DOE_new_grants_count, <span class="at">dataset =</span> <span class="st">"DOE"</span>),</span>
<span id="cb2-632"><a href="#cb2-632" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(NSF_new_grants_count, <span class="at">dataset =</span> <span class="st">"NSF"</span>),</span>
<span id="cb2-633"><a href="#cb2-633" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(NIH_new_grants_count, <span class="at">dataset =</span> <span class="st">"NIH"</span>),</span>
<span id="cb2-634"><a href="#cb2-634" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(USDA2_new_grants_count, <span class="at">dataset =</span> <span class="st">"USDA"</span>)</span>
<span id="cb2-635"><a href="#cb2-635" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-636"><a href="#cb2-636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-637"><a href="#cb2-637" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting</span></span>
<span id="cb2-638"><a href="#cb2-638" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(combined_grant_counts_df, <span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> Count, <span class="at">color =</span> dataset)) <span class="sc">+</span></span>
<span id="cb2-639"><a href="#cb2-639" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb2-640"><a href="#cb2-640" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_point(data = filter(combined_grant_counts_df, Sponsor == "NIH"), color = "green", size = 3) +  # Add points for Dataset 3- no longer need upon updating</span></span>
<span id="cb2-641"><a href="#cb2-641" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Trends Across Multiple Datasets During the Last Decade"</span>,</span>
<span id="cb2-642"><a href="#cb2-642" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Year"</span>,</span>
<span id="cb2-643"><a href="#cb2-643" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb2-644"><a href="#cb2-644" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb2-645"><a href="#cb2-645" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb2-646"><a href="#cb2-646" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="fu">min</span>(combined_grant_counts_df<span class="sc">$</span>Year, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="fu">max</span>(combined_grant_counts_df<span class="sc">$</span>Year, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">by =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb2-647"><a href="#cb2-647" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"DOE"</span> <span class="ot">=</span> <span class="st">"blue"</span>, <span class="st">"NSF"</span> <span class="ot">=</span> <span class="st">"red"</span>, <span class="st">"NIH"</span> <span class="ot">=</span> <span class="st">"green"</span>, <span class="st">"USDA"</span> <span class="ot">=</span> <span class="st">"orange"</span>)) <span class="sc">+</span></span>
<span id="cb2-648"><a href="#cb2-648" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb2-649"><a href="#cb2-649" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb2-650"><a href="#cb2-650" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb2-651"><a href="#cb2-651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-652"><a href="#cb2-652" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb2-653"><a href="#cb2-653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-654"><a href="#cb2-654" aria-hidden="true" tabindex="-1"></a>**Figure 5.** This figure shows the approximate trends of new grants received by the</span>
<span id="cb2-655"><a href="#cb2-655" aria-hidden="true" tabindex="-1"></a>University of Idaho from various sponsors in the last 10 years.</span>
<span id="cb2-656"><a href="#cb2-656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-657"><a href="#cb2-657" aria-hidden="true" tabindex="-1"></a>Limitations include that the USDA data set did not have specifications</span>
<span id="cb2-658"><a href="#cb2-658" aria-hidden="true" tabindex="-1"></a>denoting whether the awards were new or continuing, therefore, I was</span>
<span id="cb2-659"><a href="#cb2-659" aria-hidden="true" tabindex="-1"></a>only able to go off the award date for being in the last 10 years and</span>
<span id="cb2-660"><a href="#cb2-660" aria-hidden="true" tabindex="-1"></a>had to make the assumption all were new. This is most likely not the</span>
<span id="cb2-661"><a href="#cb2-661" aria-hidden="true" tabindex="-1"></a>case, so the orange line should be interpreted with caution. In general,</span>
<span id="cb2-662"><a href="#cb2-662" aria-hidden="true" tabindex="-1"></a>the USDA actually seems to be on the decline, which would be concerning</span>
<span id="cb2-663"><a href="#cb2-663" aria-hidden="true" tabindex="-1"></a>given the type of school the University of Idaho is. As for the DOE, it</span>
<span id="cb2-664"><a href="#cb2-664" aria-hidden="true" tabindex="-1"></a>seems we are on the rise during the past couple years. The NSF seems to</span>
<span id="cb2-665"><a href="#cb2-665" aria-hidden="true" tabindex="-1"></a>be steady at the moment. Meanwhile, the NIH data was interesting. Upon updating this document, grants considered "new" a week previously were not considered "new" anymore. Therefore, I just included all grants from the past 10 years. All in all, this is an interesting figure to address general trends within the last decade. </span>
<span id="cb2-666"><a href="#cb2-666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-667"><a href="#cb2-667" aria-hidden="true" tabindex="-1"></a><span class="fu"># QUESTION 3</span></span>
<span id="cb2-668"><a href="#cb2-668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-669"><a href="#cb2-669" aria-hidden="true" tabindex="-1"></a>*How is UI performing with these sponsors when compared to the following</span>
<span id="cb2-670"><a href="#cb2-670" aria-hidden="true" tabindex="-1"></a>peer institutions: Boise State University,* *Idaho State University,*</span>
<span id="cb2-671"><a href="#cb2-671" aria-hidden="true" tabindex="-1"></a>*Montana State University,* *University of Montana, and* *Washington</span>
<span id="cb2-672"><a href="#cb2-672" aria-hidden="true" tabindex="-1"></a>State University?*</span>
<span id="cb2-673"><a href="#cb2-673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-674"><a href="#cb2-674" aria-hidden="true" tabindex="-1"></a>*Note that “performing” can mean a variety of different things. You must</span>
<span id="cb2-675"><a href="#cb2-675" aria-hidden="true" tabindex="-1"></a>choose your metrics of performance and justify them.*</span>
<span id="cb2-676"><a href="#cb2-676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-677"><a href="#cb2-677" aria-hidden="true" tabindex="-1"></a>I am going to use the API sources for</span>
<span id="cb2-678"><a href="#cb2-678" aria-hidden="true" tabindex="-1"></a>this question (NIH and NSF) by manipulating the API addresses and then manipulating the data. </span>
<span id="cb2-679"><a href="#cb2-679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-680"><a href="#cb2-680" aria-hidden="true" tabindex="-1"></a><span class="in">```{r NIH5 API}</span></span>
<span id="cb2-681"><a href="#cb2-681" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the base URL for the API</span></span>
<span id="cb2-682"><a href="#cb2-682" aria-hidden="true" tabindex="-1"></a>base_url <span class="ot">&lt;-</span> <span class="st">"https://api.reporter.nih.gov/v2/projects/search"</span></span>
<span id="cb2-683"><a href="#cb2-683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-684"><a href="#cb2-684" aria-hidden="true" tabindex="-1"></a><span class="co"># This omits the `include_fields` option and downloads all the data for the University of Idaho and Boise State University from Fiscal Year 2013 to Fiscal Year 2024.</span></span>
<span id="cb2-685"><a href="#cb2-685" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-686"><a href="#cb2-686" aria-hidden="true" tabindex="-1"></a><span class="co"># Build query parameters</span></span>
<span id="cb2-687"><a href="#cb2-687" aria-hidden="true" tabindex="-1"></a>query_params <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb2-688"><a href="#cb2-688" aria-hidden="true" tabindex="-1"></a>  <span class="at">criteria =</span> <span class="fu">list</span>(</span>
<span id="cb2-689"><a href="#cb2-689" aria-hidden="true" tabindex="-1"></a>    <span class="at">fiscal_years =</span> <span class="dv">2013</span><span class="sc">:</span><span class="dv">2024</span>, <span class="co"># Specify range of fiscal years</span></span>
<span id="cb2-690"><a href="#cb2-690" aria-hidden="true" tabindex="-1"></a>    <span class="at">org_names =</span> <span class="fu">list</span>(<span class="st">"UNIVERSITY OF IDAHO"</span>, <span class="st">"BOISE STATE UNIVERSITY"</span>, <span class="st">"IDAHO STATE UNIVERSITY"</span>, <span class="st">"MONTANA STATE UNIVERSITY"</span>, <span class="st">"UNIVERSITY OF MONTANA"</span>, <span class="st">"WASHINGTON STATE UNIVERSITY"</span>)),</span>
<span id="cb2-691"><a href="#cb2-691" aria-hidden="true" tabindex="-1"></a>  <span class="at">offset =</span> <span class="dv">0</span>, <span class="co"># Starting point for fetching results.  Unlikely you'd ever want to change this.</span></span>
<span id="cb2-692"><a href="#cb2-692" aria-hidden="true" tabindex="-1"></a>  <span class="at">limit =</span> <span class="dv">500</span>, <span class="co"># Maximum number of results to fetch. Sometimes the API sets a maximum.  NIH does not.</span></span>
<span id="cb2-693"><a href="#cb2-693" aria-hidden="true" tabindex="-1"></a>  <span class="at">sort_field =</span> <span class="st">"ProjectStartDate"</span>, <span class="co"># Field to sort by.  Largely irrelevant as our visualizations should control this.</span></span>
<span id="cb2-694"><a href="#cb2-694" aria-hidden="true" tabindex="-1"></a>  <span class="at">sort_order =</span> <span class="st">"desc"</span> <span class="co"># Sort order</span></span>
<span id="cb2-695"><a href="#cb2-695" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-696"><a href="#cb2-696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-697"><a href="#cb2-697" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert query parameters to JSON format. This part is tricky.  This line converts the list above to a format (json) that the API will recognize.  This is a place where Python is way better than R.</span></span>
<span id="cb2-698"><a href="#cb2-698" aria-hidden="true" tabindex="-1"></a>query_json <span class="ot">&lt;-</span> <span class="fu">toJSON</span>(query_params, <span class="at">auto_unbox =</span> <span class="cn">TRUE</span>, <span class="at">null =</span> <span class="st">"null"</span>, <span class="at">pretty =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-699"><a href="#cb2-699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-700"><a href="#cb2-700" aria-hidden="true" tabindex="-1"></a><span class="co"># Set header information for the request.  Some instructions to the API about our query.</span></span>
<span id="cb2-701"><a href="#cb2-701" aria-hidden="true" tabindex="-1"></a>headers <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Content-Type"</span> <span class="ot">=</span> <span class="st">"application/json"</span>)</span>
<span id="cb2-702"><a href="#cb2-702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-703"><a href="#cb2-703" aria-hidden="true" tabindex="-1"></a><span class="co"># Send a POST request and retrieve response data.  POST is just a type of API interaction.  response is a json object.  Click on it in your environment to see the hierarchical structure.</span></span>
<span id="cb2-704"><a href="#cb2-704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-705"><a href="#cb2-705" aria-hidden="true" tabindex="-1"></a>response <span class="ot">&lt;-</span> <span class="fu">POST</span>(base_url, <span class="at">body =</span> query_json, <span class="at">encode =</span> <span class="st">"json"</span>, httr<span class="sc">::</span><span class="fu">add_headers</span>(<span class="at">.headers =</span> headers))</span>
<span id="cb2-706"><a href="#cb2-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-707"><a href="#cb2-707" aria-hidden="true" tabindex="-1"></a><span class="co"># Check if the request was successful.  Sometimes the error is from our code.  But sometimes it is from the API call.  Status codes help us figure out where any problems might be.</span></span>
<span id="cb2-708"><a href="#cb2-708" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">status_code</span>(response) <span class="sc">==</span> <span class="dv">200</span>) {</span>
<span id="cb2-709"><a href="#cb2-709" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract and parse JSON data</span></span>
<span id="cb2-710"><a href="#cb2-710" aria-hidden="true" tabindex="-1"></a>  json_data_NIH5 <span class="ot">&lt;-</span> <span class="fu">content</span>(response, <span class="at">as =</span> <span class="st">"text"</span>, <span class="at">encoding =</span> <span class="st">"UTF-8"</span>)</span>
<span id="cb2-711"><a href="#cb2-711" aria-hidden="true" tabindex="-1"></a>  parsed_data_NIH5 <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(json_data_NIH5, <span class="at">flatten =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-712"><a href="#cb2-712" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-713"><a href="#cb2-713" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Select columns based on the actual JSON data structure. The data frame (technically the tibble) we want is in the results component.  click on parsed_data and you'll see what I mean.</span></span>
<span id="cb2-714"><a href="#cb2-714" aria-hidden="true" tabindex="-1"></a>  projects_df5 <span class="ot">&lt;-</span> parsed_data_NIH5<span class="sc">$</span>results</span>
<span id="cb2-715"><a href="#cb2-715" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-716"><a href="#cb2-716" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-717"><a href="#cb2-717" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Print the data frame.  This is nice for debugging but you'll eventually want to stop doing this.</span></span>
<span id="cb2-718"><a href="#cb2-718" aria-hidden="true" tabindex="-1"></a>  <span class="co">#print(projects_df5)</span></span>
<span id="cb2-719"><a href="#cb2-719" aria-hidden="true" tabindex="-1"></a>  <span class="co"># knitr::kable(head(projects_df5))</span></span>
<span id="cb2-720"><a href="#cb2-720" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb2-721"><a href="#cb2-721" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Print an error message if data fetching failed</span></span>
<span id="cb2-722"><a href="#cb2-722" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Failed to fetch data: Status code"</span>, <span class="fu">status_code</span>(response)))</span>
<span id="cb2-723"><a href="#cb2-723" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Print the full response for debugging purposes</span></span>
<span id="cb2-724"><a href="#cb2-724" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">content</span>(response, <span class="at">as =</span> <span class="st">"text"</span>))</span>
<span id="cb2-725"><a href="#cb2-725" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-726"><a href="#cb2-726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-727"><a href="#cb2-727" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb2-728"><a href="#cb2-728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-729"><a href="#cb2-729" aria-hidden="true" tabindex="-1"></a><span class="in">```{r NSF5, eval = FALSE, message=FALSE}</span></span>
<span id="cb2-730"><a href="#cb2-730" aria-hidden="true" tabindex="-1"></a><span class="co"># Base URL for the API with multiple awardees</span></span>
<span id="cb2-731"><a href="#cb2-731" aria-hidden="true" tabindex="-1"></a>base_url <span class="ot">&lt;-</span> <span class="st">"https://www.research.gov/awardapi-service/v1/awards.json?awardeeName=%22regents+of+the+university+of+idaho%22%20OR%20%22boise+state+university%22%20OR%20%22idaho+state+university%22%20OR%20%22montana+state+university%22%20OR%20%22university+of+montana%22%20OR%20%22washington+state+university%22"</span></span>
<span id="cb2-732"><a href="#cb2-732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-733"><a href="#cb2-733" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-734"><a href="#cb2-734" aria-hidden="true" tabindex="-1"></a>printFields <span class="ot">&lt;-</span> <span class="st">"rpp,offset,id,agency,awardeeCity,awardeeCountryCode,awardeeDistrictCode,awardeeName,awardeeStateCode,awardeeZipCode,cfdaNumber,coPDPI,date,startDate,expDate,estimatedTotalAmt,fundsObligatedAmt,ueiNumber,fundProgramName,parentUeiNumber,pdPIName,perfCity,perfCountryCode,perfDistrictCode,perfLocation,perfStateCode,perfZipCode,poName,primaryProgram,transType,title,awardee,poPhone,poEmail,awardeeAddress,perfAddress,publicationResearch,publicationConference,fundAgencyCode,awardAgencyCode,projectOutComesReport,abstractText,piFirstName,piMiddeInitial,piLastName,piEmail"</span></span>
<span id="cb2-735"><a href="#cb2-735" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-736"><a href="#cb2-736" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize an empty data frame to store results</span></span>
<span id="cb2-737"><a href="#cb2-737" aria-hidden="true" tabindex="-1"></a>NSF5 <span class="ot">&lt;-</span> <span class="fu">tibble</span>()</span>
<span id="cb2-738"><a href="#cb2-738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-739"><a href="#cb2-739" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of results per page (as per API settings)</span></span>
<span id="cb2-740"><a href="#cb2-740" aria-hidden="true" tabindex="-1"></a>results_per_page <span class="ot">&lt;-</span> <span class="dv">25</span></span>
<span id="cb2-741"><a href="#cb2-741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-742"><a href="#cb2-742" aria-hidden="true" tabindex="-1"></a><span class="co"># Variable to keep track of the current page number</span></span>
<span id="cb2-743"><a href="#cb2-743" aria-hidden="true" tabindex="-1"></a>current_page <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb2-744"><a href="#cb2-744" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-745"><a href="#cb2-745" aria-hidden="true" tabindex="-1"></a><span class="co"># Variable to control the loop</span></span>
<span id="cb2-746"><a href="#cb2-746" aria-hidden="true" tabindex="-1"></a>keep_going <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb2-747"><a href="#cb2-747" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-748"><a href="#cb2-748" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span>(keep_going) {</span>
<span id="cb2-749"><a href="#cb2-749" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate the offset for the current page</span></span>
<span id="cb2-750"><a href="#cb2-750" aria-hidden="true" tabindex="-1"></a>    offset <span class="ot">&lt;-</span> (current_page <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> results_per_page <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb2-751"><a href="#cb2-751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-752"><a href="#cb2-752" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Construct the full URL with offset</span></span>
<span id="cb2-753"><a href="#cb2-753" aria-hidden="true" tabindex="-1"></a>    url <span class="ot">&lt;-</span> <span class="fu">paste0</span>(base_url, <span class="st">"&amp;offset="</span>, offset, <span class="st">"&amp;printFields="</span>, printFields)</span>
<span id="cb2-754"><a href="#cb2-754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-755"><a href="#cb2-755" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Make the API call</span></span>
<span id="cb2-756"><a href="#cb2-756" aria-hidden="true" tabindex="-1"></a>    response <span class="ot">&lt;-</span> <span class="fu">GET</span>(url)</span>
<span id="cb2-757"><a href="#cb2-757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-758"><a href="#cb2-758" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check if the call was successful</span></span>
<span id="cb2-759"><a href="#cb2-759" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">status_code</span>(response) <span class="sc">==</span> <span class="dv">200</span>) {</span>
<span id="cb2-760"><a href="#cb2-760" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Extract and parse the JSON data</span></span>
<span id="cb2-761"><a href="#cb2-761" aria-hidden="true" tabindex="-1"></a>        json_data_NSF5 <span class="ot">&lt;-</span> <span class="fu">content</span>(response, <span class="at">type =</span> <span class="st">"text"</span>, <span class="at">encoding =</span> <span class="st">"UTF-8"</span>)</span>
<span id="cb2-762"><a href="#cb2-762" aria-hidden="true" tabindex="-1"></a>        parsed_data_NSF5 <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(json_data_NSF5, <span class="at">flatten =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-763"><a href="#cb2-763" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-764"><a href="#cb2-764" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Extract the 'award' data and add to the all_awards data frame</span></span>
<span id="cb2-765"><a href="#cb2-765" aria-hidden="true" tabindex="-1"></a>        awards_data <span class="ot">&lt;-</span> parsed_data_NSF5<span class="sc">$</span>response<span class="sc">$</span>award</span>
<span id="cb2-766"><a href="#cb2-766" aria-hidden="true" tabindex="-1"></a>        NSF5 <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(NSF5, <span class="fu">as_tibble</span>(awards_data))</span>
<span id="cb2-767"><a href="#cb2-767" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-768"><a href="#cb2-768" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Debug: Print the current page number and number of awards fetched</span></span>
<span id="cb2-769"><a href="#cb2-769" aria-hidden="true" tabindex="-1"></a>        <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Page:"</span>, current_page, <span class="st">"- Awards fetched:"</span>, <span class="fu">length</span>(awards_data<span class="sc">$</span>id)))</span>
<span id="cb2-770"><a href="#cb2-770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-771"><a href="#cb2-771" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Check if the current page has less than results_per_page awards, then it's the last page</span></span>
<span id="cb2-772"><a href="#cb2-772" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="fu">length</span>(awards_data<span class="sc">$</span>id) <span class="sc">&lt;</span> results_per_page) {</span>
<span id="cb2-773"><a href="#cb2-773" aria-hidden="true" tabindex="-1"></a>            keep_going <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb2-774"><a href="#cb2-774" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> {</span>
<span id="cb2-775"><a href="#cb2-775" aria-hidden="true" tabindex="-1"></a>            current_page <span class="ot">&lt;-</span> current_page <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb2-776"><a href="#cb2-776" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb2-777"><a href="#cb2-777" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb2-778"><a href="#cb2-778" aria-hidden="true" tabindex="-1"></a>        <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Failed to fetch data: Status code"</span>, <span class="fu">status_code</span>(response)))</span>
<span id="cb2-779"><a href="#cb2-779" aria-hidden="true" tabindex="-1"></a>        keep_going <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb2-780"><a href="#cb2-780" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb2-781"><a href="#cb2-781" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-782"><a href="#cb2-782" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb2-783"><a href="#cb2-783" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-784"><a href="#cb2-784" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Excel for NSF5 and NIH5, warning=FALSE}</span></span>
<span id="cb2-785"><a href="#cb2-785" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(writexl)</span>
<span id="cb2-786"><a href="#cb2-786" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-787"><a href="#cb2-787" aria-hidden="true" tabindex="-1"></a><span class="co"># Write data frame to Excel file</span></span>
<span id="cb2-788"><a href="#cb2-788" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-789"><a href="#cb2-789" aria-hidden="true" tabindex="-1"></a><span class="co">#write_xlsx(projects_df5, "project_df5")</span></span>
<span id="cb2-790"><a href="#cb2-790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-791"><a href="#cb2-791" aria-hidden="true" tabindex="-1"></a><span class="co">#write_xlsx(NSF5, "NSF5.xlsx")</span></span>
<span id="cb2-792"><a href="#cb2-792" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-793"><a href="#cb2-793" aria-hidden="true" tabindex="-1"></a>NSF5 <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"NSF5.xlsx"</span>)</span>
<span id="cb2-794"><a href="#cb2-794" aria-hidden="true" tabindex="-1"></a><span class="co">#knitr::kable(head(NSFtoUI))</span></span>
<span id="cb2-795"><a href="#cb2-795" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb2-796"><a href="#cb2-796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-797"><a href="#cb2-797" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Transforming NSF5}</span></span>
<span id="cb2-798"><a href="#cb2-798" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-799"><a href="#cb2-799" aria-hidden="true" tabindex="-1"></a><span class="co"># Assuming your data is stored in a data frame called NSF5</span></span>
<span id="cb2-800"><a href="#cb2-800" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-801"><a href="#cb2-801" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to date format</span></span>
<span id="cb2-802"><a href="#cb2-802" aria-hidden="true" tabindex="-1"></a>NSF5<span class="sc">$</span><span class="st">"expDate"</span> <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(NSF5<span class="sc">$</span><span class="st">"expDate"</span>, <span class="at">format =</span> <span class="st">"%m/%d/%Y"</span>)</span>
<span id="cb2-803"><a href="#cb2-803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-804"><a href="#cb2-804" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter data for active grants </span></span>
<span id="cb2-805"><a href="#cb2-805" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter data for grants with a "expDate" on or after 03/20/2024</span></span>
<span id="cb2-806"><a href="#cb2-806" aria-hidden="true" tabindex="-1"></a>NSF5_df_active_grants <span class="ot">&lt;-</span> NSF5 <span class="sc">%&gt;%</span></span>
<span id="cb2-807"><a href="#cb2-807" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="st">`</span><span class="at">expDate</span><span class="st">`</span> <span class="sc">&gt;=</span> <span class="fu">as.Date</span>(<span class="st">"2024-03-20"</span>)) </span>
<span id="cb2-808"><a href="#cb2-808" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-809"><a href="#cb2-809" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a new data frame with filtered and selected variables from NSF5_df_active_grants</span></span>
<span id="cb2-810"><a href="#cb2-810" aria-hidden="true" tabindex="-1"></a>newNSF5 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb2-811"><a href="#cb2-811" aria-hidden="true" tabindex="-1"></a>  <span class="at">Organization =</span> NSF5_df_active_grants<span class="sc">$</span><span class="st">"awardeeName"</span>,</span>
<span id="cb2-812"><a href="#cb2-812" aria-hidden="true" tabindex="-1"></a>  <span class="at">Amount_Awarded =</span> NSF5_df_active_grants<span class="sc">$</span><span class="st">"estimatedTotalAmt"</span></span>
<span id="cb2-813"><a href="#cb2-813" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-814"><a href="#cb2-814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-815"><a href="#cb2-815" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a new column named "Sponsor" with the desired values</span></span>
<span id="cb2-816"><a href="#cb2-816" aria-hidden="true" tabindex="-1"></a>newNSF5 <span class="ot">&lt;-</span> <span class="fu">mutate</span>(newNSF5, <span class="at">Sponsor =</span> <span class="st">"NSF"</span>)</span>
<span id="cb2-817"><a href="#cb2-817" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-818"><a href="#cb2-818" aria-hidden="true" tabindex="-1"></a><span class="co"># View the modified data set</span></span>
<span id="cb2-819"><a href="#cb2-819" aria-hidden="true" tabindex="-1"></a><span class="co"># head(newNSF5)</span></span>
<span id="cb2-820"><a href="#cb2-820" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb2-821"><a href="#cb2-821" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-822"><a href="#cb2-822" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Transforming NIH5 data}</span></span>
<span id="cb2-823"><a href="#cb2-823" aria-hidden="true" tabindex="-1"></a><span class="co"># Assuming your data is stored in a dataframe called projects_df5</span></span>
<span id="cb2-824"><a href="#cb2-824" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-825"><a href="#cb2-825" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter data for grants with an "is_active" of "TRUE"</span></span>
<span id="cb2-826"><a href="#cb2-826" aria-hidden="true" tabindex="-1"></a>projects_df5_active_grants <span class="ot">&lt;-</span> projects_df5 <span class="sc">%&gt;%</span></span>
<span id="cb2-827"><a href="#cb2-827" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="st">`</span><span class="at">is_active</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"TRUE"</span>)</span>
<span id="cb2-828"><a href="#cb2-828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-829"><a href="#cb2-829" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a new column called estimated_cost_amt containing the sum of direct_cost_amt and indirect_cost_amt</span></span>
<span id="cb2-830"><a href="#cb2-830" aria-hidden="true" tabindex="-1"></a>projects_df5_active_grants<span class="sc">$</span>estimated_cost_amt <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(projects_df5_active_grants[, <span class="fu">c</span>(<span class="st">"direct_cost_amt"</span>, <span class="st">"indirect_cost_amt"</span>)])</span>
<span id="cb2-831"><a href="#cb2-831" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-832"><a href="#cb2-832" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a new data frame with filtered and selected variables from projects_df5_active_grants</span></span>
<span id="cb2-833"><a href="#cb2-833" aria-hidden="true" tabindex="-1"></a>newNIH5 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb2-834"><a href="#cb2-834" aria-hidden="true" tabindex="-1"></a>  <span class="at">Organization =</span> projects_df5_active_grants<span class="sc">$</span><span class="st">"organization.org_name"</span>,</span>
<span id="cb2-835"><a href="#cb2-835" aria-hidden="true" tabindex="-1"></a>  <span class="at">Amount_Awarded =</span> projects_df5_active_grants<span class="sc">$</span><span class="st">"estimated_cost_amt"</span></span>
<span id="cb2-836"><a href="#cb2-836" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-837"><a href="#cb2-837" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-838"><a href="#cb2-838" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a new column named "Sponsor" with the desired values</span></span>
<span id="cb2-839"><a href="#cb2-839" aria-hidden="true" tabindex="-1"></a>newNIH5 <span class="ot">&lt;-</span> <span class="fu">mutate</span>(newNIH5, <span class="at">Sponsor =</span> <span class="st">"NIH"</span>)</span>
<span id="cb2-840"><a href="#cb2-840" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-841"><a href="#cb2-841" aria-hidden="true" tabindex="-1"></a><span class="co"># View the modified data set</span></span>
<span id="cb2-842"><a href="#cb2-842" aria-hidden="true" tabindex="-1"></a><span class="co"># head(newNIH5)</span></span>
<span id="cb2-843"><a href="#cb2-843" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb2-844"><a href="#cb2-844" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-845"><a href="#cb2-845" aria-hidden="true" tabindex="-1"></a><span class="fu">## Combining NIH and NSF for neighboring schools</span></span>
<span id="cb2-846"><a href="#cb2-846" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-847"><a href="#cb2-847" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Visualizing all the schools from NIH and NSF, warning=FALSE}</span></span>
<span id="cb2-848"><a href="#cb2-848" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert Amount_Awarded_to_Date to numeric for the data set where it's stored as character</span></span>
<span id="cb2-849"><a href="#cb2-849" aria-hidden="true" tabindex="-1"></a>newNSF5 <span class="ot">&lt;-</span> newNSF5 <span class="sc">%&gt;%</span></span>
<span id="cb2-850"><a href="#cb2-850" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Amount_Awarded =</span> <span class="fu">as.numeric</span>(Amount_Awarded))</span>
<span id="cb2-851"><a href="#cb2-851" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-852"><a href="#cb2-852" aria-hidden="true" tabindex="-1"></a>combined_all_schools_active_grants_df <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb2-853"><a href="#cb2-853" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(newNSF5, <span class="at">dataset =</span> <span class="st">"NSF"</span>),</span>
<span id="cb2-854"><a href="#cb2-854" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(newNIH5, <span class="at">dataset =</span> <span class="st">"NIH"</span>)</span>
<span id="cb2-855"><a href="#cb2-855" aria-hidden="true" tabindex="-1"></a>) </span>
<span id="cb2-856"><a href="#cb2-856" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-857"><a href="#cb2-857" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a ggplot object</span></span>
<span id="cb2-858"><a href="#cb2-858" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(combined_all_schools_active_grants_df, <span class="fu">aes</span>(<span class="at">x =</span> Organization, <span class="at">y =</span> Amount_Awarded, <span class="at">fill =</span> Sponsor)) <span class="sc">+</span></span>
<span id="cb2-859"><a href="#cb2-859" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"stack"</span>) <span class="sc">+</span></span>
<span id="cb2-860"><a href="#cb2-860" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Bar Chart of Award Amounts by Sponsor and Organization"</span>,</span>
<span id="cb2-861"><a href="#cb2-861" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Organization"</span>,</span>
<span id="cb2-862"><a href="#cb2-862" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Amount Awarded"</span>,</span>
<span id="cb2-863"><a href="#cb2-863" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Sponsor"</span>) <span class="sc">+</span></span>
<span id="cb2-864"><a href="#cb2-864" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb2-865"><a href="#cb2-865" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb2-866"><a href="#cb2-866" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">1</span>))</span>
<span id="cb2-867"><a href="#cb2-867" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-868"><a href="#cb2-868" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb2-869"><a href="#cb2-869" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-870"><a href="#cb2-870" aria-hidden="true" tabindex="-1"></a>**Figure 6.** This figure shows the award amounts of the active grants of each</span>
<span id="cb2-871"><a href="#cb2-871" aria-hidden="true" tabindex="-1"></a>institution (and their various locations) sponsored by the NIH (coral)</span>
<span id="cb2-872"><a href="#cb2-872" aria-hidden="true" tabindex="-1"></a>and NSF (blue).</span>
<span id="cb2-873"><a href="#cb2-873" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-874"><a href="#cb2-874" aria-hidden="true" tabindex="-1"></a>I used the measures of active awards and their relative amounts from</span>
<span id="cb2-875"><a href="#cb2-875" aria-hidden="true" tabindex="-1"></a>these sponsors to address how the U of I compares to neighboring</span>
<span id="cb2-876"><a href="#cb2-876" aria-hidden="true" tabindex="-1"></a>institutions. Although not complex, these performance attributes capture</span>
<span id="cb2-877"><a href="#cb2-877" aria-hidden="true" tabindex="-1"></a>important metrics nonetheless.</span>
<span id="cb2-878"><a href="#cb2-878" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-879"><a href="#cb2-879" aria-hidden="true" tabindex="-1"></a>The limitations of this figure are first and foremost that it only</span>
<span id="cb2-880"><a href="#cb2-880" aria-hidden="true" tabindex="-1"></a>addresses grants from the NIH and NSF, not the USDA and DOE. I chose to</span>
<span id="cb2-881"><a href="#cb2-881" aria-hidden="true" tabindex="-1"></a>do this out of sake for convenience. Also, for the NIH, this time I</span>
<span id="cb2-882"><a href="#cb2-882" aria-hidden="true" tabindex="-1"></a>added the indirect and direct costs to compute the award amount (in</span>
<span id="cb2-883"><a href="#cb2-883" aria-hidden="true" tabindex="-1"></a>Figure 1., I only used direct cost). Further, because of the discrepant</span>
<span id="cb2-884"><a href="#cb2-884" aria-hidden="true" tabindex="-1"></a>data sources, some of the institutions have multiple locations also</span>
<span id="cb2-885"><a href="#cb2-885" aria-hidden="true" tabindex="-1"></a>shown in this figure. Although I could agglomerate the data so each</span>
<span id="cb2-886"><a href="#cb2-886" aria-hidden="true" tabindex="-1"></a>institution has one reference point, I actually think this may be</span>
<span id="cb2-887"><a href="#cb2-887" aria-hidden="true" tabindex="-1"></a>insightful to see how the smaller institutions compare to the larger</span>
<span id="cb2-888"><a href="#cb2-888" aria-hidden="true" tabindex="-1"></a>ones. In general, I could clean this figure up to look a little nicer. </span>
<span id="cb2-889"><a href="#cb2-889" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-890"><a href="#cb2-890" aria-hidden="true" tabindex="-1"></a>All in all, from this figure, we can see the U of I compares well in the</span>
<span id="cb2-891"><a href="#cb2-891" aria-hidden="true" tabindex="-1"></a>realm of NSF grants. This is not so much the case for the NIH grants.</span>
<span id="cb2-892"><a href="#cb2-892" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-893"><a href="#cb2-893" aria-hidden="true" tabindex="-1"></a><span class="fu"># SUMMARY</span></span>
<span id="cb2-894"><a href="#cb2-894" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-895"><a href="#cb2-895" aria-hidden="true" tabindex="-1"></a>In conclusion, this stuff is messy indeed! Throughout my three main</span>
<span id="cb2-896"><a href="#cb2-896" aria-hidden="true" tabindex="-1"></a>visualizations, I found out what active grants the U of I has and how</span>
<span id="cb2-897"><a href="#cb2-897" aria-hidden="true" tabindex="-1"></a>those compare across sponsors. I then expanded that information to</span>
<span id="cb2-898"><a href="#cb2-898" aria-hidden="true" tabindex="-1"></a>compare specific sponsors to various other schools nearby. In general,</span>
<span id="cb2-899"><a href="#cb2-899" aria-hidden="true" tabindex="-1"></a>we need more DOE and NIH work to be done. USDA and NSF are doing well,</span>
<span id="cb2-900"><a href="#cb2-900" aria-hidden="true" tabindex="-1"></a>but we want to get back on the rise again (at least with the USDA).</span>
<span id="cb2-901"><a href="#cb2-901" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-902"><a href="#cb2-902" aria-hidden="true" tabindex="-1"></a>I realized through this work that, as Barrie has alluded to, it indeed</span>
<span id="cb2-903"><a href="#cb2-903" aria-hidden="true" tabindex="-1"></a>does take a lot of time going through these different data and finding</span>
<span id="cb2-904"><a href="#cb2-904" aria-hidden="true" tabindex="-1"></a>what is similar/comparable and cleaning those aspects of the data in</span>
<span id="cb2-905"><a href="#cb2-905" aria-hidden="true" tabindex="-1"></a>order to put visualizations together. Further, I learned the hard way that **LESS IS MORE!** </span>
<span id="cb2-906"><a href="#cb2-906" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-907"><a href="#cb2-907" aria-hidden="true" tabindex="-1"></a>I think it would be interesting to continue to explore and see how the U</span>
<span id="cb2-908"><a href="#cb2-908" aria-hidden="true" tabindex="-1"></a>of I compares to other institutions with the other sponsors, and I</span>
<span id="cb2-909"><a href="#cb2-909" aria-hidden="true" tabindex="-1"></a>wonder how data scientists wrap their heads around all these details!</span>
<span id="cb2-910"><a href="#cb2-910" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-911"><a href="#cb2-911" aria-hidden="true" tabindex="-1"></a><span class="fu"># APPENDIX</span></span>
<span id="cb2-912"><a href="#cb2-912" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-913"><a href="#cb2-913" aria-hidden="true" tabindex="-1"></a><span class="fu">## Data Dictionary</span></span>
<span id="cb2-914"><a href="#cb2-914" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-915"><a href="#cb2-915" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Load data dictionary, warning=FALSE}</span></span>
<span id="cb2-916"><a href="#cb2-916" aria-hidden="true" tabindex="-1"></a><span class="co"># Read a specific sheet from the Excel file</span></span>
<span id="cb2-917"><a href="#cb2-917" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb2-918"><a href="#cb2-918" aria-hidden="true" tabindex="-1"></a>AwardsDictionary <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"AwardsDictionary.xlsx"</span>)</span>
<span id="cb2-919"><a href="#cb2-919" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb2-920"><a href="#cb2-920" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-921"><a href="#cb2-921" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warning = FALSE}</span></span>
<span id="cb2-922"><a href="#cb2-922" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-USDAtoUIDataDict</span></span>
<span id="cb2-923"><a href="#cb2-923" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "USDAtoUI Data Dictionary"</span></span>
<span id="cb2-924"><a href="#cb2-924" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-925"><a href="#cb2-925" aria-hidden="true" tabindex="-1"></a>AwardsDictionaryUSDAtoUI <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"AwardsDictionary.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"USDAtoUI"</span>)</span>
<span id="cb2-926"><a href="#cb2-926" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(AwardsDictionaryUSDAtoUI)</span>
<span id="cb2-927"><a href="#cb2-927" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb2-928"><a href="#cb2-928" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-929"><a href="#cb2-929" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warning = FALSE}</span></span>
<span id="cb2-930"><a href="#cb2-930" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-DOEDataDict</span></span>
<span id="cb2-931"><a href="#cb2-931" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "DOE Data Dictionary"</span></span>
<span id="cb2-932"><a href="#cb2-932" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-933"><a href="#cb2-933" aria-hidden="true" tabindex="-1"></a>AwardsDictionaryDOE <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"AwardsDictionary.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"DOE"</span>)</span>
<span id="cb2-934"><a href="#cb2-934" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(AwardsDictionaryDOE)</span>
<span id="cb2-935"><a href="#cb2-935" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb2-936"><a href="#cb2-936" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-939"><a href="#cb2-939" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb2-940"><a href="#cb2-940" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-project_dfDataDict</span></span>
<span id="cb2-941"><a href="#cb2-941" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "project_df Data Dictionary"</span></span>
<span id="cb2-942"><a href="#cb2-942" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-943"><a href="#cb2-943" aria-hidden="true" tabindex="-1"></a>AwardsDictionaryproject_df <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"AwardsDictionary.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"project_df"</span>)</span>
<span id="cb2-944"><a href="#cb2-944" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(AwardsDictionaryproject_df)</span>
<span id="cb2-945"><a href="#cb2-945" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb2-946"><a href="#cb2-946" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-949"><a href="#cb2-949" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb2-950"><a href="#cb2-950" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-NSFtoUIDataDict</span></span>
<span id="cb2-951"><a href="#cb2-951" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "NSF to UI Data Dictionary"</span></span>
<span id="cb2-952"><a href="#cb2-952" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-953"><a href="#cb2-953" aria-hidden="true" tabindex="-1"></a>AwardsDictionaryNSFtoUI <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"AwardsDictionary.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"NSFtoUI"</span>)</span>
<span id="cb2-954"><a href="#cb2-954" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(AwardsDictionaryNSFtoUI)</span>
<span id="cb2-955"><a href="#cb2-955" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>